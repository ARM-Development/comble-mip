

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Aerosol-ice nucleating particle closure &#8212; COMBLE Model-Observation Intercomparison Project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/setup/aerosol-inp-closure';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Code to generate: initial and time-varying profile and surface forcing" href="../forcing/create_comble_forcing_v2.2.html" />
    <link rel="prev" title="Aerosol specification" href="aerosol-specification.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/arm_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/arm_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    COMBLE Model-Observation Intercomparison Project Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Participants</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../participants/participants_list.html">Read Participants List Google Sheet</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How-To</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../howto/workbench_instructions.html">Apply for Elevated JupyterHub Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributers Guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Setup</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../main_configuration.html">Main Model Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerosol-specification.html">Aerosol specification</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Aerosol-ice nucleating particle closure</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DEPHY Forcing Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../forcing/create_comble_forcing_v2.2.html">Code to generate: initial and time-varying profile and surface forcing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Input Conversion Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../conversion/convert_comble_dephy_forcing_to_DHARMA_LES_and_ModelE3_SCM_forcing.html">Example: convert DEPHY forcing to DHARMA and ModelE3 formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conversion/convert_comble_dephy_forcing_to_WRF_LES_forcing.html">Example: convert DEPHY forcing to WRF-LES forcing</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Output Requested</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../output/output_list.html">Read Output List Google Sheet</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Output Conversion Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../conversion_output/convert_DHARMA_LES_output_to_dephy_format.html">Example: convert DHARMA LES output to DEPHY format</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Plot Results</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../plotting/example_plotting.html">Example plotting script for COMBLE-MIP analysis</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub.arm.gov/hub/user-redirect/git-pull?repo=https%3A//github.com/ARM-Development/comble-mip&urlpath=lab/tree/comble-mip/../user-data-home/comble-mip/notebooks/setup/aerosol-inp-closure.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/setup/aerosol-inp-closure.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Aerosol-ice nucleating particle closure</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-predicted-inps">Calculate the predicted INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-all-varaibles-in-the-output-netcdf-file">Check all varaibles in the output netcdf file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-the-dataset-of-predicted-inps">Export the dataset of predicted INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-predicted-inps-with-observed-inps">Compare the predicted INPs with observed INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="aerosol-ice-nucleating-particle-closure">
<h1>Aerosol-ice nucleating particle closure<a class="headerlink" href="#aerosol-ice-nucleating-particle-closure" title="Permalink to this heading">#</a></h1>
<p>Contributed by Yijia Sun and Daniel Knopf</p>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>By inputting the particle size distribution (PSD) information measured from COMBLE AND ZEPPELIN cases in our quickcalc module and applying with different immersion freezing (IMF) parameterizations, we can derive the number concentration of predicted ice nucleating particles (INPs). The comparison between the predicted INPs and observed INPs can be referred to as a simplistic closure study. Here, we chose the PSD of COMBLE case in 18 UTC March 13 and ZEPPELIN case in 0 UTC March 13 and performed the simulation with the assumption that all aerosols are sea spray aerosols (SSA), number concentration of aerosols in accumaltion mode is halved and aerosols in aitken mode are neglected. Three different IMF parameterizations were tested, MC2018 (singular ice nucleation active sites-based parameterization of SSA from Fig. 8 caption in McCluskey et al., JGR, 2018), PT2022 (fitted singular ice nucleation active sites-based parameterization of SSA in Peter et al., Science Advances, 2022) and ABIFM (CNT-based parameterization using water activity, parameters are from Fig. 5 in Peter et al., Science Advances, 2022). Figures of results are attached, <a href="https://photos.app.goo.gl/VyqB9fbr8vxtifhG9"> here</a>.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<p><strong>System requirements</strong>:
Be sure to implement numpy, xarray, pandas, pint and flake8 in your python environment and run this jupyter notebook in <a href="https://drive.google.com/drive/folders/1inyzNYSXqU_QP32m_fm4YJbPPOsw6QnA?usp=sharing"> this folder</a>. And we used matlab to get our finalized figures.</p>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">quickcalc</span> <span class="kn">import</span> <span class="n">quickcalc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>PSD parameters are all stored in a google sheet <a href="https://docs.google.com/spreadsheets/d/15PzDQ6rPBRDpDK9ZABW7mCNFqrILRrFvMRdxVN36VJA/edit?usp=sharing">here</a>PSD parameters are all stored in a google sheet <a href="https://docs.google.com/spreadsheets/d/15PzDQ6rPBRDpDK9ZABW7mCNFqrILRrFvMRdxVN36VJA/edit?usp=sharing">here</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aer_info1</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;COMBLE18UTCMarch13&quot;</span><span class="p">,</span>             <span class="c1">#COMBLE18UTCMarch13case</span>
                     <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">21.66e6</span><span class="p">,</span> <span class="mf">7.14e6</span><span class="p">],</span>
                      <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_logn&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.13e-6</span><span class="p">,</span><span class="mf">0.33e-6</span><span class="p">],</span>
                              <span class="s2">&quot;geom_sd&quot;</span><span class="p">:[</span><span class="mf">1.67</span><span class="p">,</span><span class="mf">1.69</span><span class="p">],</span>
                              <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                              <span class="s2">&quot;diam_min&quot;</span><span class="p">:(</span><span class="mf">0.0078e-6</span><span class="p">,</span><span class="mf">5.577e-6</span><span class="p">),</span>
                              <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">},</span>
                              <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SSA&quot;</span><span class="p">}</span>

<span class="n">aer_info2</span><span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ZEPPELIN0UTCMarch13&quot;</span><span class="p">,</span>             <span class="c1">#ZEPPELIN0UTCMarch13case</span>
                     <span class="s2">&quot;n_init_max&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">100.605e6</span><span class="p">,</span> <span class="mf">24.58e6</span><span class="p">],</span>
                      <span class="s2">&quot;psd&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;multi_logn&quot;</span><span class="p">,</span>
                              <span class="s2">&quot;diam_mean&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.13e-6</span><span class="p">,</span><span class="mf">0.61e-6</span><span class="p">],</span>
                              <span class="s2">&quot;geom_sd&quot;</span><span class="p">:[</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">1.9</span><span class="p">],</span>
                              <span class="s2">&quot;n_bins&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                              <span class="s2">&quot;diam_min&quot;</span><span class="p">:(</span><span class="mf">0.0059e-6</span><span class="p">,</span><span class="mf">11.59e-6</span><span class="p">),</span>
                              <span class="s2">&quot;m_ratio&quot;</span><span class="p">:</span><span class="mf">1.5</span><span class="p">},</span>
                              <span class="s2">&quot;nucleus_type&quot;</span><span class="p">:</span> <span class="s2">&quot;SSA&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-the-predicted-inps">
<h2>Calculate the predicted INPs<a class="headerlink" href="#calculate-the-predicted-inps" title="Permalink to this heading">#</a></h2>
<p>The activation time of 1min for ABIFM is the same as mentioned in Peter et al., Science Advances, 2022. And all implemented equations for IMF parameterizations can be found in AER.py.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qqq1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">qqq2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">qqq3</span><span class="o">=</span><span class="p">[]</span>
<span class="n">ttt1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">ttt2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">ttt3</span><span class="o">=</span><span class="p">[]</span>


<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1">#COMBLE18UTCMarch13case</span>
        <span class="n">qq1</span> <span class="o">=</span> <span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">aer_info1</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;PT2022&quot;</span><span class="p">}},</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">)</span>  
        <span class="n">qqq1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qq1</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">qq2</span> <span class="o">=</span> <span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">aer_info1</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;MC2018&quot;</span><span class="p">}},</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">)</span>  
        <span class="n">qqq2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qq2</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">qq3</span> <span class="o">=</span><span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="n">aer_info1</span><span class="p">,</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">ABIFM_delta_t</span><span class="o">=</span><span class="mf">60.</span><span class="p">)</span>  
        <span class="n">qqq3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qq3</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="c1">#ZEPPELIN0UTCMarch13case</span>
        <span class="n">tt1</span> <span class="o">=</span> <span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">aer_info2</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;PT2022&quot;</span><span class="p">}},</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">)</span>  
        <span class="n">ttt1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt1</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">tt2</span> <span class="o">=</span> <span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">aer_info2</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s2">&quot;singular_fun&quot;</span><span class="p">:</span> <span class="s2">&quot;MC2018&quot;</span><span class="p">}},</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">)</span>  
        <span class="n">ttt2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt2</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">tt3</span> <span class="o">=</span><span class="n">quickcalc</span><span class="p">(</span><span class="n">aer_info_dict</span><span class="o">=</span><span class="n">aer_info2</span><span class="p">,</span> <span class="n">T_in</span><span class="o">=</span><span class="mi">243</span><span class="o">+</span><span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_ABIFM</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">RH_in</span><span class="o">=</span><span class="mf">99.5</span><span class="p">,</span> <span class="n">ABIFM_delta_t</span><span class="o">=</span><span class="mf">60.</span><span class="p">)</span>  
        <span class="n">ttt3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tt3</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;inp_tot&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        
</pre></div>
</div>
</div>
</div>
</section>
<section id="check-all-varaibles-in-the-output-netcdf-file">
<h2>Check all varaibles in the output netcdf file<a class="headerlink" href="#check-all-varaibles-in-the-output-netcdf-file" title="Permalink to this heading">#</a></h2>
<p>qq1</p>
</section>
<section id="export-the-dataset-of-predicted-inps">
<h2>Export the dataset of predicted INPs<a class="headerlink" href="#export-the-dataset-of-predicted-inps" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">qqq1</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAPT2022COMBLE18UTCMarch13.csv&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">qqq2</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAMC2018COMBLE18UTCMarch13.csv&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">qqq3</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAABIFMCOMBLE18UTCMarch13.csv&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ttt1</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAPT2022ZEPPELIN0UTCMarch13.csv&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ttt2</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAMC2018ZEPPELIN0UTCMarch13.csv&#39;</span><span class="p">)</span>
<span class="n">test</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ttt3</span><span class="p">)</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;SSAABIFMZEPPELIN0UTCMarch13.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-the-predicted-inps-with-observed-inps">
<h2>Compare the predicted INPs with observed INPs<a class="headerlink" href="#compare-the-predicted-inps-with-observed-inps" title="Permalink to this heading">#</a></h2>
<p>The number concentration of observed INPs can be found in Sample details: 3.12.20 - 3.14.20 in 17 CAOS from <a href="https://docs.google.com/spreadsheets/d/1eYupJDFb1VFpXFJvR-ZZo-onJJvEgGa7JTm7GsVOrCk/edit?usp=sharing">here</a>. By running the <a href="https://drive.google.com/drive/folders/1yO6psVcruXTB0DRIItP5DzzB3jXYFU2a?usp=sharing">matlab code</a> named with “COMBLE” and “ZEPPELIN”, you can easily get the figures of the results.</p>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>Based on our assumption (all aerosols are sea spray aerosols (SSA), number concentration of aerosols in accumaltion mode is halved and aerosols in aitken mode are neglected), in COMBLE18UTCMarch13case, the predicted INPs applied with ABIFM and PT2022 are mostly close to observed INPs. While in ZEPPELIN0UTCMarch13, the predicted INPs applied with MC2018 are mostly close to observed INPs.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Thanks for Israel who wrote the original version of quickcalc module, we can easily derive the number concentration of predicted ice nucleating particles with different IMF parameterizations and we thank Ann for supplying the dataset of observed INPs and aerosol PSD parameters.</p></li>
<li><p>Knopf et al. (A 1D model for nucleation of ice from aerosol particles: an application to mixed-phase arctic stratus, submitted to Journal of Advances in Modeling Earth Systems, 2023) used a simplified 1D aerosol-cloud model informed by a large-eddy simulation (LES) to examine the ice nucleating particle (INP) reservoir dynamics of Arctic mixed-phase clouds (MPCs) during the Surface Heat Budget of the Arctic campaign (SHEBA), already showed the potential of this 1D model in deriving the predicted INP with different IMF parameterizations.</p></li>
<li><p>A manuscript is currently in preparation (Sun et al., <em>in prep</em>). This manuscript further investigates the impacts of different types of aerosol properties, IMF parameterizations, and various model sensitivity parameters on the MPCs processes.</p></li>
<li><p>Contact yijia.sun&#64;stonybrook.edu if you have any questions.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/setup"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="aerosol-specification.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Aerosol specification</p>
      </div>
    </a>
    <a class="right-next"
       href="../forcing/create_comble_forcing_v2.2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Code to generate: initial and time-varying profile and surface forcing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-predicted-inps">Calculate the predicted INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-all-varaibles-in-the-output-netcdf-file">Check all varaibles in the output netcdf file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-the-dataset-of-predicted-inps">Export the dataset of predicted INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-predicted-inps-with-observed-inps">Compare the predicted INPs with observed INPs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ARM Development Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>