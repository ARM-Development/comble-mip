
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Generate time-varying surface forcing &#8212; COMBLE Model-Observation Intercomparison Project</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/arm_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">COMBLE Model-Observation Intercomparison Project</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    COMBLE Model-observation Intercomparison Project Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Forcing Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="forcing/create_comble_nudging_forcing_era5ml_v1.6.html">
   Generate initial and time-varying nudging profiles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="forcing/create_comble_sfc_forcing_era5ml_v1.6.html">
   Generate time-varying surface forcing
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ARM-Development/comble-mip/main?urlpath=lab/tree/notebooks/create_comble_sfc_forcing_era5ml_v1.6.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://jupyterhub.arm.gov/hub/user-redirect/git-pull?repo=https%3A//github.com/ARM-Development/comble-mip&urlpath=lab/tree/comble-mip/notebooks/create_comble_sfc_forcing_era5ml_v1.6.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/notebooks/create_comble_sfc_forcing_era5ml_v1.6.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-to-generate-only-time-varying-surface-forcing-based-on-backward-trajectory-and-high-res-sea-ice-satellite-data-for-comble-les-scm-intercomparison">
   Code to generate ONLY time-varying surface forcing based on backward trajectory and high-res sea ice satellite data for COMBLE LES/SCM intercomparison
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#developed-by-tim-juliano-at-ncar-ral-originally-on-8-26-22">
     Developed by Tim Juliano at NCAR/RAL originally on 8/26/22
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v1-6-created-on-1-18-22">
     v1.6 created on 1/18/22
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">
     We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#includes-lat-lon-correction-by-peng-wu-pnnl">
     Includes lat/lon correction by Peng Wu (PNNL)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-libraries">
     Import libraries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#user-mods">
     !!! User mods !!!
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-many-hours-before-ice-edge-do-you-want-to-start">
       How many hours before ice edge do you want to start?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">
       Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note-t0-h-must-be-an-integer">
       Note: t0_h must be an integer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-some-things">
     Set some things
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forcing-netcdf-name-and-delete-file-if-already-exists">
     Forcing NetCDF name and delete file if already exists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-les-domain-locations">
     Get LES domain locations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-sea-ice-concentration-along-trajectory">
     Calculate sea ice concentration along trajectory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-era5-backtrajectory-netcdf">
     Read in data from ERA5 backtrajectory (netCDF)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">
     Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">
     Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-time-series-information-for-sfc-forcing">
     Get time series information for sfc forcing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-new-netcdf-file">
     Create new netcdf file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dimensions">
     Create dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-global-attributes">
     Create global attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-variables">
     Create variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dimensions">
       Dimensions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#time-varying-forcing-surface">
       Time-varying forcing - surface
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-data">
     Write data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-times">
     Add times
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#close-the-file">
     Close the file
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Generate time-varying surface forcing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#code-to-generate-only-time-varying-surface-forcing-based-on-backward-trajectory-and-high-res-sea-ice-satellite-data-for-comble-les-scm-intercomparison">
   Code to generate ONLY time-varying surface forcing based on backward trajectory and high-res sea ice satellite data for COMBLE LES/SCM intercomparison
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#developed-by-tim-juliano-at-ncar-ral-originally-on-8-26-22">
     Developed by Tim Juliano at NCAR/RAL originally on 8/26/22
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#v1-6-created-on-1-18-22">
     v1.6 created on 1/18/22
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">
     We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#includes-lat-lon-correction-by-peng-wu-pnnl">
     Includes lat/lon correction by Peng Wu (PNNL)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-libraries">
     Import libraries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#user-mods">
     !!! User mods !!!
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#how-many-hours-before-ice-edge-do-you-want-to-start">
       How many hours before ice edge do you want to start?
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">
       Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#note-t0-h-must-be-an-integer">
       Note: t0_h must be an integer
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-some-things">
     Set some things
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forcing-netcdf-name-and-delete-file-if-already-exists">
     Forcing NetCDF name and delete file if already exists
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-les-domain-locations">
     Get LES domain locations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-sea-ice-concentration-along-trajectory">
     Calculate sea ice concentration along trajectory
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-era5-backtrajectory-netcdf">
     Read in data from ERA5 backtrajectory (netCDF)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">
     Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">
     Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-time-series-information-for-sfc-forcing">
     Get time series information for sfc forcing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-new-netcdf-file">
     Create new netcdf file
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dimensions">
     Create dimensions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-global-attributes">
     Create global attributes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-variables">
     Create variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#dimensions">
       Dimensions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#time-varying-forcing-surface">
       Time-varying forcing - surface
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#write-data">
     Write data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-times">
     Add times
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#close-the-file">
     Close the file
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="generate-time-varying-surface-forcing">
<h1>Generate time-varying surface forcing<a class="headerlink" href="#generate-time-varying-surface-forcing" title="Permalink to this headline">#</a></h1>
<section id="code-to-generate-only-time-varying-surface-forcing-based-on-backward-trajectory-and-high-res-sea-ice-satellite-data-for-comble-les-scm-intercomparison">
<h2>Code to generate ONLY time-varying surface forcing based on backward trajectory and high-res sea ice satellite data for COMBLE LES/SCM intercomparison<a class="headerlink" href="#code-to-generate-only-time-varying-surface-forcing-based-on-backward-trajectory-and-high-res-sea-ice-satellite-data-for-comble-les-scm-intercomparison" title="Permalink to this headline">#</a></h2>
<section id="developed-by-tim-juliano-at-ncar-ral-originally-on-8-26-22">
<h3>Developed by Tim Juliano at NCAR/RAL originally on 8/26/22<a class="headerlink" href="#developed-by-tim-juliano-at-ncar-ral-originally-on-8-26-22" title="Permalink to this headline">#</a></h3>
</section>
<section id="v1-6-created-on-1-18-22">
<h3>v1.6 created on 1/18/22<a class="headerlink" href="#v1-6-created-on-1-18-22" title="Permalink to this headline">#</a></h3>
</section>
<section id="we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">
<h3>We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)<a class="headerlink" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc" title="Permalink to this headline">#</a></h3>
</section>
<section id="includes-lat-lon-correction-by-peng-wu-pnnl">
<h3>Includes lat/lon correction by Peng Wu (PNNL)<a class="headerlink" href="#includes-lat-lon-correction-by-peng-wu-pnnl" title="Permalink to this headline">#</a></h3>
</section>
<section id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">date2num</span><span class="p">,</span><span class="n">num2date</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">geopy.distance</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
<span class="kn">import</span> <span class="nn">gdal</span>
<span class="kn">import</span> <span class="nn">copy</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="user-mods">
<h3>!!! User mods !!!<a class="headerlink" href="#user-mods" title="Permalink to this headline">#</a></h3>
<section id="how-many-hours-before-ice-edge-do-you-want-to-start">
<h4>How many hours before ice edge do you want to start?<a class="headerlink" href="#how-many-hours-before-ice-edge-do-you-want-to-start" title="Permalink to this headline">#</a></h4>
</section>
<section id="note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">
<h4>Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge<a class="headerlink" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge" title="Permalink to this headline">#</a></h4>
</section>
<section id="note-t0-h-must-be-an-integer">
<h4>Note: t0_h must be an integer<a class="headerlink" href="#note-t0-h-must-be-an-integer" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_h</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">if</span> <span class="n">t0_h</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">t0_h</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Error: Please set 0 &lt;= t0_h &gt;= 10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="set-some-things">
<h3>Set some things<a class="headerlink" href="#set-some-things" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nhrs</span> <span class="o">=</span> <span class="mi">18</span> <span class="o">+</span> <span class="n">t0_h</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># total number of simulation hours, including t0; default is from 2020-03-12 at 14 UTC to 2020-03-14 at 00 UTC</span>
<span class="k">if</span> <span class="n">t0_h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="s1">&#39;2020-03-13 00:00:00&#39;</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="s1">&#39;2020-03-12 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">24</span><span class="o">-</span><span class="n">t0_h</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:00:00&#39;</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">24</span><span class="o">-</span><span class="n">t0_h</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Start time is: &#39;</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Start time is: 2020-03-12 14:00:00
</pre></div>
</div>
</div>
</div>
</section>
<section id="forcing-netcdf-name-and-delete-file-if-already-exists">
<h3>Forcing NetCDF name and delete file if already exists<a class="headerlink" href="#forcing-netcdf-name-and-delete-file-if-already-exists" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">savename</span> <span class="o">=</span> <span class="s1">&#39;COMBLE_INTERCOMPARISON_SFC_FORCING_ERA5ML_V1.6.nc&#39;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">savename</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The file &#39;</span> <span class="o">+</span> <span class="n">savename</span> <span class="o">+</span> <span class="s1">&#39; has been deleted successfully&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The file COMBLE_INTERCOMPARISON_SFC_FORCING_ERA5ML_V1.6.nc has been deleted successfully
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-les-domain-locations">
<h3>Get LES domain locations<a class="headerlink" href="#get-les-domain-locations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;LES_domain_location_28h_18Z_Mar13_2020.txt&#39;</span>

<span class="n">les_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">les_hh</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">les_hh_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">les_hh</span><span class="o">&gt;=-</span><span class="mf">1.</span><span class="o">*</span><span class="n">t0_h</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">les_lat</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[</span><span class="n">les_hh_idx</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">les_lon</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[</span><span class="n">les_hh_idx</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">les_lat_mid</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">les_lat</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">les_lon_mid</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">les_lon</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;LES domain mid point: &#39;</span> <span class="o">+</span> <span class="s1">&#39;lat=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">les_lat_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;N, lon=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">les_lon_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LES domain mid point: lat=77.6N, lon=8.6E
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-sea-ice-concentration-along-trajectory">
<h3>Calculate sea ice concentration along trajectory<a class="headerlink" href="#calculate-sea-ice-concentration-along-trajectory" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sic_file</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;Svalbard_asi-AMSR2-n10m-20200313_m.nc&#39;</span><span class="p">)</span>
<span class="n">sic</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">][:,:]</span>
<span class="n">sic_lat</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">sic_lon</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>

<span class="c1"># Read high-res domain location file</span>
<span class="n">les_loc_hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">les_hh_hr</span> <span class="o">=</span> <span class="n">les_loc_hr</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">les_hh_hr_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">les_hh_hr</span><span class="o">&gt;=-</span><span class="mf">1.</span><span class="o">*</span><span class="n">t0_h</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#print (les_hh_hr[les_hh_hr_idx])</span>
<span class="n">les_lat_hr</span> <span class="o">=</span> <span class="n">les_loc_hr</span><span class="p">[</span><span class="n">les_hh_hr_idx</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">les_lon_hr</span> <span class="o">=</span> <span class="n">les_loc_hr</span><span class="p">[</span><span class="n">les_hh_hr_idx</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="c1">#print (les_lat_hr)</span>

<span class="n">sic_traj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_hh_hr_idx</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_hh_hr_idx</span><span class="p">)):</span>
    <span class="n">abslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sic_lat</span><span class="o">-</span><span class="n">les_lat_hr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">abslon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sic_lon</span><span class="o">-</span><span class="n">les_lon_hr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">jlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">abslat</span><span class="p">)</span>
    <span class="n">ilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">abslon</span><span class="p">)</span>
    <span class="c1">#print (les_lat[i],les_lon[i])</span>
    <span class="c1">#print (jlat,ilon)</span>
    <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sic</span><span class="p">[</span><span class="n">jlat</span><span class="p">,</span><span class="n">ilon</span><span class="p">]</span>
    <span class="c1">#print (les_lat_hr[i],les_lon_hr[i],les_hh_hr[les_hh_hr_idx[i]],sic_traj[i])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-in-data-from-era5-backtrajectory-netcdf">
<h3>Read in data from ERA5 backtrajectory (netCDF)<a class="headerlink" href="#read-in-data-from-era5-backtrajectory-netcdf" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># File name</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;theta_temp_rh_sh_uvw_sst_along_trajectory_era5ml_28h_end_2020-03-13-18.nc&#39;</span>

<span class="c1"># Open dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="c1"># Read variables (1D arrays are time, 2D arrays are time x pressure level)</span>
<span class="n">hours</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][:]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">][:]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">][:]</span>
<span class="c1">#pres = dataset.variables[&#39;Pressure&#39;][:]</span>
<span class="c1">#sfc_pres = dataset.variables[&#39;SfcPres&#39;][:]</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">][:]</span>
<span class="c1">#hgt = dataset.variables[&#39;GEOS_HT&#39;][:,:]</span>
<span class="c1">#uwnd = dataset.variables[&#39;U&#39;][:,:]</span>
<span class="c1">#vwnd = dataset.variables[&#39;V&#39;][:,:]</span>
<span class="c1">#wwnd = dataset.variables[&#39;W&#39;][:,:]</span>
<span class="c1">#temp = dataset.variables[&#39;Temp&#39;][:,:]</span>
<span class="c1">#theta = dataset.variables[&#39;Theta&#39;][:,:]</span>
<span class="c1">#qv = dataset.variables[&#39;SH&#39;][:,:]</span>
<span class="c1">#o3 = dataset.variables[&#39;O3&#39;][:,:]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">
<h3>Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position<a class="headerlink" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#hgt = np.flip(hgt,axis=0)</span>
<span class="c1">#uwnd = np.flip(uwnd,axis=0)</span>
<span class="c1">#vwnd = np.flip(vwnd,axis=0)</span>
<span class="c1">#wwnd = np.flip(wwnd,axis=0)</span>
<span class="c1">#temp = np.flip(temp,axis=0)</span>
<span class="c1">#theta = np.flip(theta,axis=0)</span>
<span class="c1">#qv = np.flip(qv,axis=0)</span>
<span class="c1">#o3 = np.flip(o3,axis=0)</span>
<span class="c1">#sfc_pres_pa = sfc_pres_pa[::-1]</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">
<h3>Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)<a class="headerlink" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_real</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">sst</span><span class="p">)</span>
<span class="n">loopidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sst_real</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">loopidx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-time-series-information-for-sfc-forcing">
<h3>Get time series information for sfc forcing<a class="headerlink" href="#get-time-series-information-for-sfc-forcing" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate SST</span>
<span class="n">tmp_hh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># these are the hours we have SST data from the ERA5 backward trajectory file</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tmp_hh</span><span class="p">,</span> <span class="n">sst</span><span class="p">[</span><span class="n">t0</span><span class="p">:])</span>
<span class="n">sst_interp</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">les_hh_hr</span><span class="p">[</span><span class="n">les_hh_hr_idx</span><span class="p">])</span>
<span class="c1">#print (sst_interp)</span>

<span class="c1"># Modification for over ice/MIZ</span>
<span class="n">tsk_ice</span> <span class="o">=</span> <span class="mf">247.0</span>
<span class="n">sst_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">)):</span>
    <span class="c1">#if t0_h == 10:</span>
    <span class="c1">#    if i == 0:</span>
    <span class="c1">#        # Insert first position since backward trajectory file does not have t=0 (-28h)</span>
    <span class="c1">#        sst_ts[i] = tsk_ice</span>
    <span class="c1">#        print (&#39;Computed TSK for hour &#39; + str(round(5*i/60.,3)) + &#39;: &#39; + str(round(sst_ts[i],3)))</span>
    <span class="k">if</span> <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">90.0</span><span class="p">:</span> <span class="c1"># over ice</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsk_ice</span>
    <span class="k">elif</span> <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c1"># MIZ</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span><span class="o">*</span><span class="n">tsk_ice</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">))</span><span class="o">*</span><span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># MIZ</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># open ocean</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1">#if t0_h == 10:</span>
    <span class="c1">#    # Do some printing magic</span>
    <span class="c1">#    print (&#39;Computed TSK for hour &#39; + str(round(5/60.+5*i/60.,3)) + &#39;: &#39;</span>
    <span class="c1">#           + str(round(sst_ts[i],3)) + &#39; with SIC = &#39; + str(sic_traj[i]/100.) +</span>
    <span class="c1">#           &#39; and SST = &#39; + str(round(sst_interp[i],3)))</span>
    <span class="c1">#else:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Computed TSK for hour &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mf">60.</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span>
           <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; with SIC = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span> <span class="o">+</span>
           <span class="s1">&#39; and SST = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>
    
<span class="c1"># Insert first position since</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed TSK for hour 0.0: 247.0 with SIC = 0.96 and SST = 271.46
Computed TSK for hour 0.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.25: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.5: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 0.583: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 0.667: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 0.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.833: 247.0 with SIC = 0.96 and SST = 271.46
Computed TSK for hour 0.917: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.0: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.167: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 1.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.583: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 1.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 1.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 1.833: 247.0 with SIC = 0.96 and SST = 271.46
Computed TSK for hour 1.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 2.25: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 2.333: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.833: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 2.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.583: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 3.667: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 3.75: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.833: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.917: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.0: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.333: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.833: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.167: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.25: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.333: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 5.75: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 5.833: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 5.917: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.0: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 6.583: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 6.667: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 6.75: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 6.833: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 6.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 7.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 7.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 7.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 7.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.833: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 7.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 8.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 8.083: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 8.167: 247.0 with SIC = 0.96 and SST = 271.46
Computed TSK for hour 8.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 8.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 8.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 8.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 8.583: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 8.667: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 8.75: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 8.833: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 8.917: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 9.0: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 9.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 9.167: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 9.25: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 9.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 9.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 9.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 9.583: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 9.667: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 9.75: 247.0 with SIC = 0.95 and SST = 271.46
Computed TSK for hour 9.833: 247.0 with SIC = 0.95 and SST = 271.46
Computed TSK for hour 9.917: 249.935 with SIC = 0.88 and SST = 271.46
Computed TSK for hour 10.0: 249.935 with SIC = 0.88 and SST = 271.46
Computed TSK for hour 10.083: 247.0 with SIC = 0.95 and SST = 271.652
Computed TSK for hour 10.167: 247.0 with SIC = 0.95 and SST = 271.844
Computed TSK for hour 10.25: 263.774 with SIC = 0.33 and SST = 272.035
Computed TSK for hour 10.333: 263.902 with SIC = 0.33 and SST = 272.227
Computed TSK for hour 10.417: 264.031 with SIC = 0.33 and SST = 272.419
Computed TSK for hour 10.5: 265.184 with SIC = 0.29 and SST = 272.611
Computed TSK for hour 10.583: 265.32 with SIC = 0.29 and SST = 272.803
Computed TSK for hour 10.667: 269.615 with SIC = 0.13 and SST = 272.994
Computed TSK for hour 10.75: 269.782 with SIC = 0.13 and SST = 273.186
Computed TSK for hour 10.833: 271.004 with SIC = 0.09 and SST = 273.378
Computed TSK for hour 10.917: 268.256 with SIC = 0.2 and SST = 273.57
Computed TSK for hour 11.0: 271.086 with SIC = 0.1 and SST = 273.762
Computed TSK for hour 11.083: 271.207 with SIC = 0.1 and SST = 273.897
Computed TSK for hour 11.167: 271.329 with SIC = 0.1 and SST = 274.032
Computed TSK for hour 11.25: 274.167 with SIC = 0.0 and SST = 274.167
Computed TSK for hour 11.333: 274.302 with SIC = 0.0 and SST = 274.302
Computed TSK for hour 11.417: 274.437 with SIC = 0.0 and SST = 274.437
Computed TSK for hour 11.5: 274.572 with SIC = 0.0 and SST = 274.572
Computed TSK for hour 11.583: 274.707 with SIC = 0.0 and SST = 274.707
Computed TSK for hour 11.667: 274.842 with SIC = 0.0 and SST = 274.842
Computed TSK for hour 11.75: 274.978 with SIC = 0.0 and SST = 274.978
Computed TSK for hour 11.833: 275.113 with SIC = 0.0 and SST = 275.113
Computed TSK for hour 11.917: 275.248 with SIC = 0.0 and SST = 275.248
Computed TSK for hour 12.0: 275.383 with SIC = 0.0 and SST = 275.383
Computed TSK for hour 12.083: 275.366 with SIC = 0.0 and SST = 275.366
Computed TSK for hour 12.167: 275.349 with SIC = 0.0 and SST = 275.349
Computed TSK for hour 12.25: 275.333 with SIC = 0.0 and SST = 275.333
Computed TSK for hour 12.333: 275.316 with SIC = 0.0 and SST = 275.316
Computed TSK for hour 12.417: 275.299 with SIC = 0.0 and SST = 275.299
Computed TSK for hour 12.5: 275.282 with SIC = 0.0 and SST = 275.282
Computed TSK for hour 12.583: 275.265 with SIC = 0.0 and SST = 275.265
Computed TSK for hour 12.667: 275.249 with SIC = 0.0 and SST = 275.249
Computed TSK for hour 12.75: 275.232 with SIC = 0.0 and SST = 275.232
Computed TSK for hour 12.833: 275.215 with SIC = 0.0 and SST = 275.215
Computed TSK for hour 12.917: 275.198 with SIC = 0.0 and SST = 275.198
Computed TSK for hour 13.0: 275.182 with SIC = 0.0 and SST = 275.182
Computed TSK for hour 13.083: 275.205 with SIC = 0.0 and SST = 275.205
Computed TSK for hour 13.167: 275.228 with SIC = 0.0 and SST = 275.228
Computed TSK for hour 13.25: 275.251 with SIC = 0.0 and SST = 275.251
Computed TSK for hour 13.333: 275.275 with SIC = 0.0 and SST = 275.275
Computed TSK for hour 13.417: 275.298 with SIC = 0.0 and SST = 275.298
Computed TSK for hour 13.5: 275.321 with SIC = 0.0 and SST = 275.321
Computed TSK for hour 13.583: 275.345 with SIC = 0.0 and SST = 275.345
Computed TSK for hour 13.667: 275.368 with SIC = 0.0 and SST = 275.368
Computed TSK for hour 13.75: 275.391 with SIC = 0.0 and SST = 275.391
Computed TSK for hour 13.833: 275.414 with SIC = 0.0 and SST = 275.414
Computed TSK for hour 13.917: 275.438 with SIC = 0.0 and SST = 275.438
Computed TSK for hour 14.0: 275.461 with SIC = 0.0 and SST = 275.461
Computed TSK for hour 14.083: 275.489 with SIC = 0.0 and SST = 275.489
Computed TSK for hour 14.167: 275.518 with SIC = 0.0 and SST = 275.518
Computed TSK for hour 14.25: 275.546 with SIC = 0.0 and SST = 275.546
Computed TSK for hour 14.333: 275.575 with SIC = 0.0 and SST = 275.575
Computed TSK for hour 14.417: 275.603 with SIC = 0.0 and SST = 275.603
Computed TSK for hour 14.5: 275.632 with SIC = 0.0 and SST = 275.632
Computed TSK for hour 14.583: 275.66 with SIC = 0.0 and SST = 275.66
Computed TSK for hour 14.667: 275.689 with SIC = 0.0 and SST = 275.689
Computed TSK for hour 14.75: 275.717 with SIC = 0.0 and SST = 275.717
Computed TSK for hour 14.833: 275.746 with SIC = 0.0 and SST = 275.746
Computed TSK for hour 14.917: 275.774 with SIC = 0.0 and SST = 275.774
Computed TSK for hour 15.0: 275.803 with SIC = 0.0 and SST = 275.803
Computed TSK for hour 15.083: 275.841 with SIC = 0.0 and SST = 275.841
Computed TSK for hour 15.167: 275.88 with SIC = 0.0 and SST = 275.88
Computed TSK for hour 15.25: 275.918 with SIC = 0.0 and SST = 275.918
Computed TSK for hour 15.333: 275.956 with SIC = 0.0 and SST = 275.956
Computed TSK for hour 15.417: 275.995 with SIC = 0.0 and SST = 275.995
Computed TSK for hour 15.5: 276.033 with SIC = 0.0 and SST = 276.033
Computed TSK for hour 15.583: 276.072 with SIC = 0.0 and SST = 276.072
Computed TSK for hour 15.667: 276.11 with SIC = 0.0 and SST = 276.11
Computed TSK for hour 15.75: 276.148 with SIC = 0.0 and SST = 276.148
Computed TSK for hour 15.833: 276.187 with SIC = 0.0 and SST = 276.187
Computed TSK for hour 15.917: 276.225 with SIC = 0.0 and SST = 276.225
Computed TSK for hour 16.0: 276.264 with SIC = 0.0 and SST = 276.264
Computed TSK for hour 16.083: 276.288 with SIC = 0.0 and SST = 276.288
Computed TSK for hour 16.167: 276.313 with SIC = 0.0 and SST = 276.313
Computed TSK for hour 16.25: 276.338 with SIC = 0.0 and SST = 276.338
Computed TSK for hour 16.333: 276.362 with SIC = 0.0 and SST = 276.362
Computed TSK for hour 16.417: 276.387 with SIC = 0.0 and SST = 276.387
Computed TSK for hour 16.5: 276.412 with SIC = 0.0 and SST = 276.412
Computed TSK for hour 16.583: 276.436 with SIC = 0.0 and SST = 276.436
Computed TSK for hour 16.667: 276.461 with SIC = 0.0 and SST = 276.461
Computed TSK for hour 16.75: 276.486 with SIC = 0.0 and SST = 276.486
Computed TSK for hour 16.833: 276.51 with SIC = 0.0 and SST = 276.51
Computed TSK for hour 16.917: 276.535 with SIC = 0.0 and SST = 276.535
Computed TSK for hour 17.0: 276.56 with SIC = 0.0 and SST = 276.56
Computed TSK for hour 17.083: 276.578 with SIC = 0.0 and SST = 276.578
Computed TSK for hour 17.167: 276.596 with SIC = 0.0 and SST = 276.596
Computed TSK for hour 17.25: 276.614 with SIC = 0.0 and SST = 276.614
Computed TSK for hour 17.333: 276.632 with SIC = 0.0 and SST = 276.632
Computed TSK for hour 17.417: 276.65 with SIC = 0.0 and SST = 276.65
Computed TSK for hour 17.5: 276.668 with SIC = 0.0 and SST = 276.668
Computed TSK for hour 17.583: 276.687 with SIC = 0.0 and SST = 276.687
Computed TSK for hour 17.667: 276.705 with SIC = 0.0 and SST = 276.705
Computed TSK for hour 17.75: 276.723 with SIC = 0.0 and SST = 276.723
Computed TSK for hour 17.833: 276.741 with SIC = 0.0 and SST = 276.741
Computed TSK for hour 17.917: 276.759 with SIC = 0.0 and SST = 276.759
Computed TSK for hour 18.0: 276.777 with SIC = 0.0 and SST = 276.777
Computed TSK for hour 18.083: 276.821 with SIC = 0.0 and SST = 276.821
Computed TSK for hour 18.167: 276.864 with SIC = 0.0 and SST = 276.864
Computed TSK for hour 18.25: 276.908 with SIC = 0.0 and SST = 276.908
Computed TSK for hour 18.333: 276.951 with SIC = 0.0 and SST = 276.951
Computed TSK for hour 18.417: 276.995 with SIC = 0.0 and SST = 276.995
Computed TSK for hour 18.5: 277.039 with SIC = 0.0 and SST = 277.039
Computed TSK for hour 18.583: 277.082 with SIC = 0.0 and SST = 277.082
Computed TSK for hour 18.667: 277.126 with SIC = 0.0 and SST = 277.126
Computed TSK for hour 18.75: 277.169 with SIC = 0.0 and SST = 277.169
Computed TSK for hour 18.833: 277.213 with SIC = 0.0 and SST = 277.213
Computed TSK for hour 18.917: 277.256 with SIC = 0.0 and SST = 277.256
Computed TSK for hour 19.0: 277.3 with SIC = 0.0 and SST = 277.3
Computed TSK for hour 19.083: 277.345 with SIC = 0.0 and SST = 277.345
Computed TSK for hour 19.167: 277.391 with SIC = 0.0 and SST = 277.391
Computed TSK for hour 19.25: 277.436 with SIC = 0.0 and SST = 277.436
Computed TSK for hour 19.333: 277.481 with SIC = 0.0 and SST = 277.481
Computed TSK for hour 19.417: 277.527 with SIC = 0.0 and SST = 277.527
Computed TSK for hour 19.5: 277.572 with SIC = 0.0 and SST = 277.572
Computed TSK for hour 19.583: 277.618 with SIC = 0.0 and SST = 277.618
Computed TSK for hour 19.667: 277.663 with SIC = 0.0 and SST = 277.663
Computed TSK for hour 19.75: 277.708 with SIC = 0.0 and SST = 277.708
Computed TSK for hour 19.833: 277.754 with SIC = 0.0 and SST = 277.754
Computed TSK for hour 19.917: 277.799 with SIC = 0.0 and SST = 277.799
Computed TSK for hour 20.0: 277.845 with SIC = 0.0 and SST = 277.845
Computed TSK for hour 20.083: 277.856 with SIC = 0.0 and SST = 277.856
Computed TSK for hour 20.167: 277.868 with SIC = 0.0 and SST = 277.868
Computed TSK for hour 20.25: 277.879 with SIC = 0.0 and SST = 277.879
Computed TSK for hour 20.333: 277.89 with SIC = 0.0 and SST = 277.89
Computed TSK for hour 20.417: 277.902 with SIC = 0.0 and SST = 277.902
Computed TSK for hour 20.5: 277.913 with SIC = 0.0 and SST = 277.913
Computed TSK for hour 20.583: 277.924 with SIC = 0.0 and SST = 277.924
Computed TSK for hour 20.667: 277.936 with SIC = 0.0 and SST = 277.936
Computed TSK for hour 20.75: 277.947 with SIC = 0.0 and SST = 277.947
Computed TSK for hour 20.833: 277.959 with SIC = 0.0 and SST = 277.959
Computed TSK for hour 20.917: 277.97 with SIC = 0.0 and SST = 277.97
Computed TSK for hour 21.0: 277.981 with SIC = 0.0 and SST = 277.981
Computed TSK for hour 21.083: 277.998 with SIC = 0.0 and SST = 277.998
Computed TSK for hour 21.167: 278.014 with SIC = 0.0 and SST = 278.014
Computed TSK for hour 21.25: 278.031 with SIC = 0.0 and SST = 278.031
Computed TSK for hour 21.333: 278.047 with SIC = 0.0 and SST = 278.047
Computed TSK for hour 21.417: 278.063 with SIC = 0.0 and SST = 278.063
Computed TSK for hour 21.5: 278.08 with SIC = 0.0 and SST = 278.08
Computed TSK for hour 21.583: 278.096 with SIC = 0.0 and SST = 278.096
Computed TSK for hour 21.667: 278.112 with SIC = 0.0 and SST = 278.112
Computed TSK for hour 21.75: 278.129 with SIC = 0.0 and SST = 278.129
Computed TSK for hour 21.833: 278.145 with SIC = 0.0 and SST = 278.145
Computed TSK for hour 21.917: 278.161 with SIC = 0.0 and SST = 278.161
Computed TSK for hour 22.0: 278.178 with SIC = 0.0 and SST = 278.178
Computed TSK for hour 22.083: 278.208 with SIC = 0.0 and SST = 278.208
Computed TSK for hour 22.167: 278.238 with SIC = 0.0 and SST = 278.238
Computed TSK for hour 22.25: 278.269 with SIC = 0.0 and SST = 278.269
Computed TSK for hour 22.333: 278.299 with SIC = 0.0 and SST = 278.299
Computed TSK for hour 22.417: 278.329 with SIC = 0.0 and SST = 278.329
Computed TSK for hour 22.5: 278.359 with SIC = 0.0 and SST = 278.359
Computed TSK for hour 22.583: 278.39 with SIC = 0.0 and SST = 278.39
Computed TSK for hour 22.667: 278.42 with SIC = 0.0 and SST = 278.42
Computed TSK for hour 22.75: 278.45 with SIC = 0.0 and SST = 278.45
Computed TSK for hour 22.833: 278.48 with SIC = 0.0 and SST = 278.48
Computed TSK for hour 22.917: 278.511 with SIC = 0.0 and SST = 278.511
Computed TSK for hour 23.0: 278.541 with SIC = 0.0 and SST = 278.541
Computed TSK for hour 23.083: 278.592 with SIC = 0.0 and SST = 278.592
Computed TSK for hour 23.167: 278.642 with SIC = 0.0 and SST = 278.642
Computed TSK for hour 23.25: 278.693 with SIC = 0.0 and SST = 278.693
Computed TSK for hour 23.333: 278.744 with SIC = 0.0 and SST = 278.744
Computed TSK for hour 23.417: 278.795 with SIC = 0.0 and SST = 278.795
Computed TSK for hour 23.5: 278.845 with SIC = 0.0 and SST = 278.845
Computed TSK for hour 23.583: 278.896 with SIC = 0.0 and SST = 278.896
Computed TSK for hour 23.667: 278.947 with SIC = 0.0 and SST = 278.947
Computed TSK for hour 23.75: 278.997 with SIC = 0.0 and SST = 278.997
Computed TSK for hour 23.833: 279.048 with SIC = 0.0 and SST = 279.048
Computed TSK for hour 23.917: 279.099 with SIC = 0.0 and SST = 279.099
Computed TSK for hour 24.0: 279.149 with SIC = 0.0 and SST = 279.149
Computed TSK for hour 24.083: 279.169 with SIC = 0.0 and SST = 279.169
Computed TSK for hour 24.167: 279.188 with SIC = 0.0 and SST = 279.188
Computed TSK for hour 24.25: 279.207 with SIC = 0.0 and SST = 279.207
Computed TSK for hour 24.333: 279.227 with SIC = 0.0 and SST = 279.227
Computed TSK for hour 24.417: 279.246 with SIC = 0.0 and SST = 279.246
Computed TSK for hour 24.5: 279.265 with SIC = 0.0 and SST = 279.265
Computed TSK for hour 24.583: 279.284 with SIC = 0.0 and SST = 279.284
Computed TSK for hour 24.667: 279.304 with SIC = 0.0 and SST = 279.304
Computed TSK for hour 24.75: 279.323 with SIC = 0.0 and SST = 279.323
Computed TSK for hour 24.833: 279.342 with SIC = 0.0 and SST = 279.342
Computed TSK for hour 24.917: 279.362 with SIC = 0.0 and SST = 279.362
Computed TSK for hour 25.0: 279.381 with SIC = 0.0 and SST = 279.381
Computed TSK for hour 25.083: 279.385 with SIC = 0.0 and SST = 279.385
Computed TSK for hour 25.167: 279.39 with SIC = 0.0 and SST = 279.39
Computed TSK for hour 25.25: 279.394 with SIC = 0.0 and SST = 279.394
Computed TSK for hour 25.333: 279.399 with SIC = 0.0 and SST = 279.399
Computed TSK for hour 25.417: 279.403 with SIC = 0.0 and SST = 279.403
Computed TSK for hour 25.5: 279.408 with SIC = 0.0 and SST = 279.408
Computed TSK for hour 25.583: 279.412 with SIC = 0.0 and SST = 279.412
Computed TSK for hour 25.667: 279.417 with SIC = 0.0 and SST = 279.417
Computed TSK for hour 25.75: 279.421 with SIC = 0.0 and SST = 279.421
Computed TSK for hour 25.833: 279.426 with SIC = 0.0 and SST = 279.426
Computed TSK for hour 25.917: 279.43 with SIC = 0.0 and SST = 279.43
Computed TSK for hour 26.0: 279.435 with SIC = 0.0 and SST = 279.435
Computed TSK for hour 26.083: 279.425 with SIC = 0.0 and SST = 279.425
Computed TSK for hour 26.167: 279.416 with SIC = 0.0 and SST = 279.416
Computed TSK for hour 26.25: 279.407 with SIC = 0.0 and SST = 279.407
Computed TSK for hour 26.333: 279.397 with SIC = 0.0 and SST = 279.397
Computed TSK for hour 26.417: 279.388 with SIC = 0.0 and SST = 279.388
Computed TSK for hour 26.5: 279.379 with SIC = 0.0 and SST = 279.379
Computed TSK for hour 26.583: 279.37 with SIC = 0.0 and SST = 279.37
Computed TSK for hour 26.667: 279.36 with SIC = 0.0 and SST = 279.36
Computed TSK for hour 26.75: 279.351 with SIC = 0.0 and SST = 279.351
Computed TSK for hour 26.833: 279.342 with SIC = 0.0 and SST = 279.342
Computed TSK for hour 26.917: 279.333 with SIC = 0.0 and SST = 279.333
Computed TSK for hour 27.0: 279.323 with SIC = 0.0 and SST = 279.323
Computed TSK for hour 27.083: 279.195 with SIC = 0.0 and SST = 279.195
Computed TSK for hour 27.167: 279.068 with SIC = 0.0 and SST = 279.068
Computed TSK for hour 27.25: 278.94 with SIC = 0.0 and SST = 278.94
Computed TSK for hour 27.333: 278.812 with SIC = 0.0 and SST = 278.812
Computed TSK for hour 27.417: 278.684 with SIC = 0.0 and SST = 278.684
Computed TSK for hour 27.5: 278.557 with SIC = 0.0 and SST = 278.557
Computed TSK for hour 27.583: 278.429 with SIC = 0.0 and SST = 278.429
Computed TSK for hour 27.667: 278.301 with SIC = 0.0 and SST = 278.301
Computed TSK for hour 27.75: 278.173 with SIC = 0.0 and SST = 278.173
Computed TSK for hour 27.833: 278.046 with SIC = 0.0 and SST = 278.046
Computed TSK for hour 27.917: 277.918 with SIC = 0.0 and SST = 277.918
Computed TSK for hour 28.0: 277.79 with SIC = 0.0 and SST = 277.79
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-new-netcdf-file">
<h3>Create new netcdf file<a class="headerlink" href="#create-new-netcdf-file" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># just to be safe, make sure dataset is not already open.</span>
<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
<span class="n">ncfile</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="n">savename</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;NETCDF3_CLASSIC&#39;</span><span class="p">)</span> 
<span class="c1">#print(ncfile)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-dimensions">
<h3>Create dimensions<a class="headerlink" href="#create-dimensions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#levs = len(zgeoi)</span>
<span class="c1">#levs_o3 = len(pres_t0_o3)</span>
<span class="c1">#z_grid_levs = len(z_grid)</span>
<span class="c1">#t0_dim = ncfile.createDimension(&#39;t0&#39;, 1)     # initial time axis</span>
<span class="c1">#lat_dim = ncfile.createDimension(&#39;lat&#39;, 1)     # latitude axis</span>
<span class="c1">#lon_dim = ncfile.createDimension(&#39;lon&#39;, 1)     # longitude axis</span>
<span class="c1">#lev_dim = ncfile.createDimension(&#39;lev&#39;, levs)      # level axis</span>
<span class="c1">#pres_o3_dim = ncfile.createDimension(&#39;pres_o3&#39;, levs_o3)      # level axis for o3</span>
<span class="c1">#zw_grid_dim = ncfile.createDimension(&#39;zw_grid&#39;, z_grid_levs)      # zw_grid axis</span>
<span class="n">time_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>    <span class="c1"># unlimited axis (can be appended to)</span>
<span class="c1">#for dim in ncfile.dimensions.items():</span>
<span class="c1">#    print(dim)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-global-attributes">
<h3>Create global attributes<a class="headerlink" href="#create-global-attributes" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncfile</span><span class="o">.</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Forcing and initial conditions for 13 March 2020 COMBLE intercomparison case&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">reference</span><span class="o">=</span><span class="s1">&#39;https://comble-intercomparison.readthedocs.io/en/latest/&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">authors</span><span class="o">=</span><span class="s1">&#39;Timothy W. Juliano (NCAR/RAL, tjuliano@ucar.edu); Florian Tornow (NASA/GISS, ft2544@columbia.edu); Ann M. Fridlind (NASA/GISS, ann.fridlind@nasa.gov)&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;Created on 2022-11-21&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">format_version</span><span class="o">=</span><span class="s1">&#39;DEPHY SCM format version 1.6&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">script</span><span class="o">=</span><span class="s1">&#39;create_comble_forcing.ipynb&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">startDate</span><span class="o">=</span><span class="n">start_time</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">endDate</span><span class="o">=</span><span class="s1">&#39;2020-03-13 18:00:00&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">force_geo</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">surfaceType</span><span class="o">=</span><span class="s1">&#39;ocean&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">surfaceForcing</span><span class="o">=</span><span class="s1">&#39;ts&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">les_lat_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; deg N&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dx</span><span class="o">=</span><span class="s1">&#39;150 m&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dy</span><span class="o">=</span><span class="s1">&#39;150 m&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dz</span><span class="o">=</span><span class="s1">&#39;see zw_grid variable&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">nx</span><span class="o">=</span><span class="s1">&#39;648&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">ny</span><span class="o">=</span><span class="s1">&#39;648&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">nz</span><span class="o">=</span><span class="s1">&#39;160&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-variables">
<h3>Create variables<a class="headerlink" href="#create-variables" title="Permalink to this headline">#</a></h3>
<section id="dimensions">
<h4>Dimensions<a class="headerlink" href="#dimensions" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#t0_time = ncfile.createVariable(&#39;t0&#39;, np.float32, (&#39;t0&#39;,))</span>
<span class="c1">#t0_time.units = &#39;seconds since 2020-03-12 22:00:00&#39;</span>
<span class="c1">#t0_time.long_name = &#39;Initial time&#39;</span>

<span class="c1">#latitude = ncfile.createVariable(&#39;lat&#39;, np.float32, (&#39;lat&#39;,))</span>
<span class="c1">#latitude.units = &#39;degrees_north&#39;</span>
<span class="c1">#latitude.long_name = &#39;latitude&#39;</span>

<span class="c1">#longitude = ncfile.createVariable(&#39;lon&#39;, np.float32, (&#39;lon&#39;,))</span>
<span class="c1">#longitude.units = &#39;degrees_east&#39;</span>
<span class="c1">#longitude.long_name = &#39;longitude&#39;</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,))</span>
<span class="n">time</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;seconds since &#39;</span> <span class="o">+</span> <span class="n">start_time</span>
<span class="n">time</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>

<span class="c1">#lev = ncfile.createVariable(&#39;lev&#39;, np.float64, (&#39;lev&#39;,))</span>
<span class="c1">#lev.units = &#39;m&#39;</span>
<span class="c1">#lev.long_name = &#39;altitude&#39;</span>

<span class="c1">#pressure_o3 = ncfile.createVariable(&#39;pres_o3&#39;, np.float64, (&#39;pres_o3&#39;,))</span>
<span class="c1">#pressure_o3.units = &#39;Pa&#39;</span>
<span class="c1">#pressure_o3.long_name = &#39;pressure for o3&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-varying-forcing-surface">
<h4>Time-varying forcing - surface<a class="headerlink" href="#time-varying-forcing-surface" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;ts&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,))</span>
<span class="n">ts</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">ts</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;surface temperature&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="write-data">
<h3>Write data<a class="headerlink" href="#write-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">sst_ts</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-times">
<h3>Add times<a class="headerlink" href="#add-times" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">nmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mi">18</span> <span class="o">+</span> <span class="n">t0_h</span><span class="p">)</span><span class="o">*</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">curr_hh</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">start_hour</span><span class="p">)</span>
<span class="n">curr_dd</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">start_day</span><span class="p">)</span>
<span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">first_pass</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmin</span><span class="p">):</span>
    <span class="n">curr_min</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ii</span>
    <span class="k">if</span> <span class="n">curr_min</span> <span class="o">%</span> <span class="mi">60</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">first_pass</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">curr_hh</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">curr_min</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">ii</span>
        <span class="k">if</span> <span class="n">curr_hh</span> <span class="o">==</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">curr_hh</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">curr_dd</span><span class="o">+=</span><span class="mi">1</span>
    
    <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">curr_dd</span><span class="p">,</span><span class="n">curr_hh</span><span class="p">,</span><span class="n">curr_min</span><span class="p">))</span>
    
    <span class="n">first_pass</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
<span class="c1">#print (dates)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<span class="n">time</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">times</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="close-the-file">
<h3>Close the file<a class="headerlink" href="#close-the-file" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first print the Dataset object to see what we&#39;ve got</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="c1"># close the Dataset.</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">();</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dataset is closed!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;
root group (NETCDF3_CLASSIC data model, file format NETCDF3):
    title: Forcing and initial conditions for 13 March 2020 COMBLE intercomparison case
    reference: https://comble-intercomparison.readthedocs.io/en/latest/
    authors: Timothy W. Juliano (NCAR/RAL, tjuliano@ucar.edu); Florian Tornow (NASA/GISS, ft2544@columbia.edu); Ann M. Fridlind (NASA/GISS, ann.fridlind@nasa.gov)
    version: Created on 2022-11-21
    format_version: DEPHY SCM format version 1.6
    script: create_comble_forcing.ipynb
    startDate: 2020-03-12 14:00:00
    endDate: 2020-03-13 18:00:00
    force_geo: 1
    surfaceType: ocean
    surfaceForcing: ts
    lat: 77.6 deg N
    dx: 150 m
    dy: 150 m
    dz: see zw_grid variable
    nx: 648
    ny: 648
    nz: 160
    dimensions(sizes): time(337)
    variables(dimensions): float64 time(time), float64 ts(time)
    groups: 
Dataset is closed!
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ARM Development Team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>