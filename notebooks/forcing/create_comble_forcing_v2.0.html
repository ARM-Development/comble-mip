

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Generate initial and time-varying profile and surface forcing &#8212; COMBLE Model-Observation Intercomparison Project</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/forcing/create_comble_forcing_v2.0';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Example: convert DEPHY forcing to DHARMA and ModelE3 forcings" href="../conversion/convert_comble_dephy_forcing_to_DHARMA_LES_and_ModelE3_SCM_forcing.html" />
    <link rel="prev" title="Apply for Elevated JupyterHub Access" href="../howto/workbench_instructions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/arm_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/arm_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    COMBLE Model-Observation Intercomparison Project Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Participants</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../participants/participants_list.html">Read Participants List Google Sheet</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How-To</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../howto/workbench_instructions.html">Apply for Elevated JupyterHub Access</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DEPHY Forcing Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Generate initial and time-varying profile and surface forcing</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Input Conversion Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../conversion/convert_comble_dephy_forcing_to_DHARMA_LES_and_ModelE3_SCM_forcing.html">Example: convert DEPHY forcing to DHARMA and ModelE3 forcings</a></li>

<li class="toctree-l1"><a class="reference internal" href="../conversion/convert_comble_dephy_forcing_to_WRF_LES_forcing.html">Example: convert DEPHY forcing to WRF-LES forcing</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Setup</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../setup/read-metadata-sheet.html">Read Metadata Google Sheet</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Model Output Requested</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../output/output_list.html">Read Output List Google Sheet</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Output Conversion Notebooks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../conversion_output/convert_DHARMA_LES_output_to_dephy_format.html">Example: convert DHARMA LES output to DEPHY format</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://jupyterhub.arm.gov/hub/user-redirect/git-pull?repo=https%3A//github.com/ARM-Development/comble-mip&urlpath=lab/tree/comble-mip/../user-data-home/comble-mip/notebooks/forcing/create_comble_forcing_v2.0.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/forcing/create_comble_forcing_v2.0.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Generate initial and time-varying profile and surface forcing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Generate initial and time-varying profile and surface forcing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#developed-by-tim-juliano-ncar-ral-ann-fridlind-nasa-giss-and-florian-tornow-nasa-giss-columbia-univ">Developed by Tim Juliano (NCAR/RAL), Ann Fridlind (NASA-GISS), and Florian Tornow (NASA-GISS/Columbia Univ.)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#v2-0-created-on-6-1-23">v2.0 created on 6/1/23</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-mods">!!! User mods !!!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-hours-before-ice-edge-do-you-want-to-start">How many hours before ice edge do you want to start?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-t0-h-must-be-an-integer">Note: t0_h must be an integer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-things">Set some things</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forcing-netcdf-name-and-delete-file-if-already-exists">Forcing NetCDF name and delete file if already exists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-les-domain-locations">Get LES domain locations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-vertical-grid">Create vertical grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertical-grid-levels-defined-at-the-cell-faces">160 vertical grid levels, defined at the cell faces</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-data-from-era5-backtrajectory-netcdf">Read in data from ERA5 backtrajectory (netCDF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-units">Convert units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-sfc-potential-temperature">Calculate sfc potential temperature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-information-at-t0">Get information at t0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extrapolate-o3-since-era5-only-goes-to-1-hpa-and-plot-versus-original-profile">Extrapolate O3 since ERA5 only goes to 1 hPa and plot versus original profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-geostrophic-wind-forcing">Get Geostrophic wind forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-extrapolate-ug-vg-to-native-era5-levels">Interpolate/extrapolate Ug/Vg to native ERA5 levels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-t0-profiles-nudging-profiles-and-geostrophic-wind-profiles-to-common-vertical-grid-for-simplicity">Interpolate t0 profiles, nudging profiles, and geostrophic wind profiles to common vertical grid for simplicity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-time-with-highest-first-level-and-get-vertical-grid">Find time with highest first level and get vertical grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-of-time-varying-geostrophic-profiles-to-new-vertical-grid">Do the linear interpolation of time-varying geostrophic profiles to new vertical grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-profiles-of-time-varying-geostrophic-wind-as-example-to-show-efficacy-of-method">Compare original and interpolated profiles of time-varying geostrophic wind as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-for-initial-forcing-profiles">Do the linear interpolation for initial forcing profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-for-nudging-forcing-profiles">Do the linear interpolation for nudging forcing profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-profiles-of-time-varying-nudging-wind-as-example-to-show-efficacy-of-method">Compare original and interpolated profiles of time-varying nudging wind as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-intial-profiles-as-example-to-show-efficacy-of-method">Compare original and interpolated intial profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-nudging-profiles-as-example-to-show-efficacy-of-method">Compare original and interpolated nudging profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Compare original and interpolated nudging profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ageostrophic-winds">Compute ageostrophic winds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#do-sfc-forcing">DO SFC FORCING</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-sea-ice-concentration-along-trajectory">Calculate sea ice concentration along trajectory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-time-series-information-for-sfc-forcing">Get time series information for sfc forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-new-netcdf-file">Create new netcdf file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-dimensions">Create dimensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-global-attributes">Create global attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-variables">Create variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensions">Dimensions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-profiles">Initial profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-sfc-conditions">Initial sfc conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-geostrophic">Time-varying forcing - geostrophic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-nudging">Time-varying forcing - nudging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-surface">Time-varying forcing - surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#misc">Misc</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-data">Write data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-times">Add times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#close-the-file">Close the file</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="generate-initial-and-time-varying-profile-and-surface-forcing">
<h1>Generate initial and time-varying profile and surface forcing<a class="headerlink" href="#generate-initial-and-time-varying-profile-and-surface-forcing" title="Permalink to this heading">#</a></h1>
<section id="developed-by-tim-juliano-ncar-ral-ann-fridlind-nasa-giss-and-florian-tornow-nasa-giss-columbia-univ">
<h2>Developed by Tim Juliano (NCAR/RAL), Ann Fridlind (NASA-GISS), and Florian Tornow (NASA-GISS/Columbia Univ.)<a class="headerlink" href="#developed-by-tim-juliano-ncar-ral-ann-fridlind-nasa-giss-and-florian-tornow-nasa-giss-columbia-univ" title="Permalink to this heading">#</a></h2>
</section>
<section id="v2-0-created-on-6-1-23">
<h2>v2.0 created on 6/1/23<a class="headerlink" href="#v2-0-created-on-6-1-23" title="Permalink to this heading">#</a></h2>
</section>
<section id="we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">
<h2>We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)<a class="headerlink" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc" title="Permalink to this heading">#</a></h2>
</section>
<section id="import-libraries">
<h2>Import libraries<a class="headerlink" href="#import-libraries" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netCDF4</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="k">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">date2num</span><span class="p">,</span><span class="n">num2date</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">geopy.distance</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
<span class="kn">import</span> <span class="nn">gdal</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="user-mods">
<h2>!!! User mods !!!<a class="headerlink" href="#user-mods" title="Permalink to this heading">#</a></h2>
<section id="how-many-hours-before-ice-edge-do-you-want-to-start">
<h3>How many hours before ice edge do you want to start?<a class="headerlink" href="#how-many-hours-before-ice-edge-do-you-want-to-start" title="Permalink to this heading">#</a></h3>
</section>
<section id="note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">
<h3>Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge<a class="headerlink" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge" title="Permalink to this heading">#</a></h3>
</section>
<section id="note-t0-h-must-be-an-integer">
<h3>Note: t0_h must be an integer<a class="headerlink" href="#note-t0-h-must-be-an-integer" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_h</span> <span class="o">=</span> <span class="mi">5</span>
<span class="k">if</span> <span class="n">t0_h</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">t0_h</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s1">&#39;Error: Please set 0 &lt;= t0_h &gt;= 10&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="set-some-things">
<h2>Set some things<a class="headerlink" href="#set-some-things" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nhrs</span> <span class="o">=</span> <span class="mi">18</span> <span class="o">+</span> <span class="n">t0_h</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># total number of simulation hours, including t0; default is from 2020-03-12 at 14 UTC to 2020-03-14 at 00 UTC</span>
<span class="k">if</span> <span class="n">t0_h</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="s1">&#39;2020-03-13 00:00:00&#39;</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="s1">&#39;2020-03-12 &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">24</span><span class="o">-</span><span class="n">t0_h</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:00:00&#39;</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">start_hour</span> <span class="o">=</span> <span class="mi">24</span><span class="o">-</span><span class="n">t0_h</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Start time is: &#39;</span> <span class="o">+</span> <span class="n">start_time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Start time is: 2020-03-12 19:00:00
</pre></div>
</div>
</div>
</div>
</section>
<section id="forcing-netcdf-name-and-delete-file-if-already-exists">
<h2>Forcing NetCDF name and delete file if already exists<a class="headerlink" href="#forcing-netcdf-name-and-delete-file-if-already-exists" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">savename</span> <span class="o">=</span> <span class="s1">&#39;COMBLE_INTERCOMPARISON_FORCING_ERA5ML_V2.0.nc&#39;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">savename</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The file &#39;</span> <span class="o">+</span> <span class="n">savename</span> <span class="o">+</span> <span class="s1">&#39; has been deleted successfully&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The file COMBLE_INTERCOMPARISON_FORCING_ERA5ML_V2.0.nc has been deleted successfully
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-les-domain-locations">
<h2>Get LES domain locations<a class="headerlink" href="#get-les-domain-locations" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fname_les_domain</span> <span class="o">=</span> <span class="s1">&#39;LES_domain_location_28h_18Z_Mar13_2020.txt&#39;</span>

<span class="n">les_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname_les_domain</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">les_hh</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">les_hh_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">les_hh</span><span class="o">&gt;=-</span><span class="mf">1.</span><span class="o">*</span><span class="n">t0_h</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">les_lat</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[</span><span class="n">les_hh_idx</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">les_lat2</span> <span class="o">=</span> <span class="n">les_lat</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span>
<span class="n">les_lon</span> <span class="o">=</span> <span class="n">les_loc</span><span class="p">[</span><span class="n">les_hh_idx</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">les_lon2</span> <span class="o">=</span> <span class="n">les_lon</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span>

<span class="n">les_lat_mid</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">les_lat</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">les_lon_mid</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">les_lon</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;LES domain mid point: &#39;</span> <span class="o">+</span> <span class="s1">&#39;lat=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">les_lat_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;N, lon=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">les_lon_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LES domain mid point: lat=75.6N, lon=9.0E
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-vertical-grid">
<h2>Create vertical grid<a class="headerlink" href="#create-vertical-grid" title="Permalink to this heading">#</a></h2>
<section id="vertical-grid-levels-defined-at-the-cell-faces">
<h3>160 vertical grid levels, defined at the cell faces<a class="headerlink" href="#vertical-grid-levels-defined-at-the-cell-faces" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nz</span> <span class="o">=</span> <span class="mi">160</span>

<span class="n">dz_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">25.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">35.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">140</span><span class="p">]</span> <span class="o">=</span> <span class="mf">40.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">140</span><span class="p">]</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">141</span><span class="p">:</span><span class="mi">157</span><span class="p">]</span> <span class="o">=</span> <span class="mf">80.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">157</span><span class="p">]</span> <span class="o">=</span> <span class="mf">60.0</span>
<span class="n">dz_grid</span><span class="p">[</span><span class="mi">158</span><span class="p">]</span> <span class="o">=</span> <span class="mf">50.0</span>

<span class="n">z_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">nz</span><span class="p">)</span>
<span class="n">z_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">z_grid</span><span class="p">)):</span>
    <span class="n">z_grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">z_grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dz_grid</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="read-in-data-from-era5-backtrajectory-netcdf">
<h2>Read in data from ERA5 backtrajectory (netCDF)<a class="headerlink" href="#read-in-data-from-era5-backtrajectory-netcdf" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># File name</span>
<span class="n">fname_era5</span> <span class="o">=</span> <span class="s1">&#39;theta_temp_rh_sh_uvw_sst_along_trajectory_era5ml_28h_end_2020-03-13-18.nc&#39;</span>

<span class="c1"># Open dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">fname_era5</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="c1"># Read variables (1D arrays are time, 2D arrays are time x pressure level)</span>
<span class="n">hours</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">][:]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">][:]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">][:]</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">][:]</span>
<span class="n">sfc_pres</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;SfcPres&#39;</span><span class="p">][:]</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">][:]</span>
<span class="n">hgt</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;GEOS_HT&#39;</span><span class="p">][:,:]</span>
<span class="n">uwnd</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">][:,:]</span>
<span class="n">vwnd</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">][:,:]</span>
<span class="n">wwnd</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;W&#39;</span><span class="p">][:,:]</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Temp&#39;</span><span class="p">][:,:]</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Theta&#39;</span><span class="p">][:,:]</span>
<span class="n">qv</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;SH&#39;</span><span class="p">][:,:]</span>

<span class="c1"># File name</span>
<span class="n">fname_era5_o3</span> <span class="o">=</span> <span class="s1">&#39;ERA5_forcing_along_trajectory_end_2020-03-13-18.nc&#39;</span>

<span class="c1"># Open dataset</span>
<span class="n">dataset_o3</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">fname_era5_o3</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">o3</span> <span class="o">=</span> <span class="n">dataset_o3</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;O3&#39;</span><span class="p">][:,:]</span>
<span class="n">pres_o3</span> <span class="o">=</span> <span class="n">dataset_o3</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;Pressure&#39;</span><span class="p">][:]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="convert-units">
<h2>Convert units<a class="headerlink" href="#convert-units" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sfc_pres_pa</span> <span class="o">=</span> <span class="n">sfc_pres</span><span class="o">/</span><span class="mf">100.</span>  <span class="c1"># Pa to hPa</span>
<span class="n">pres_pa</span> <span class="o">=</span> <span class="n">pres</span><span class="o">*</span><span class="mf">100.</span>          <span class="c1"># hPa to Pa</span>
<span class="n">pres_o3_pa</span> <span class="o">=</span> <span class="n">pres_o3</span><span class="o">*</span><span class="mf">100.</span>    <span class="c1"># hPa to Pa</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">
<h2>Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position<a class="headerlink" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hgt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">hgt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">uwnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">uwnd</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">vwnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">vwnd</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">wwnd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wwnd</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">qv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">qv</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">o3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">o3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sfc_pres_pa</span> <span class="o">=</span> <span class="n">sfc_pres_pa</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">
<h2>Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)<a class="headerlink" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sst_real</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">sst</span><span class="p">)</span>
<span class="n">loopidx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sst_real</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">t0</span> <span class="o">=</span> <span class="n">loopidx</span><span class="p">[</span><span class="mi">10</span><span class="o">-</span><span class="n">t0_h</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-sfc-potential-temperature">
<h2>Calculate sfc potential temperature<a class="headerlink" href="#calculate-sfc-potential-temperature" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta1000mb</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sfc_theta</span> <span class="o">=</span> <span class="n">theta1000mb</span><span class="o">*</span><span class="nb">pow</span><span class="p">((</span><span class="mf">1000.</span><span class="o">/</span><span class="n">sfc_pres_pa</span><span class="p">),</span><span class="mf">0.286</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-information-at-t0">
<h2>Get information at t0<a class="headerlink" href="#get-information-at-t0" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z1</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">pres_t0</span> <span class="o">=</span> <span class="n">pres_pa</span><span class="p">[</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">pres_o3_t0</span> <span class="o">=</span> <span class="n">pres_o3_pa</span><span class="p">[</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">hgt_t0</span> <span class="o">=</span> <span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">uwnd_t0</span> <span class="o">=</span> <span class="n">uwnd</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">vwnd_t0</span> <span class="o">=</span> <span class="n">vwnd</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">wwnd_t0</span> <span class="o">=</span> <span class="n">wwnd</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">temp_t0</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">theta_t0</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>
<span class="n">qv_t0</span> <span class="o">=</span> <span class="n">qv</span><span class="p">[</span><span class="n">t0</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>

<span class="c1"># temporal avg for o3</span>
<span class="n">o3_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">o3</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ps_t0</span> <span class="o">=</span> <span class="n">sfc_pres_pa</span><span class="p">[</span><span class="n">t0</span><span class="p">]</span>
<span class="n">thetas_t0</span> <span class="o">=</span> <span class="n">sfc_theta</span><span class="p">[</span><span class="n">t0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="extrapolate-o3-since-era5-only-goes-to-1-hpa-and-plot-versus-original-profile">
<h2>Extrapolate O3 since ERA5 only goes to 1 hPa and plot versus original profile<a class="headerlink" href="#extrapolate-o3-since-era5-only-goes-to-1-hpa-and-plot-versus-original-profile" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add top pressure and o3 value - here we assume o3 goes to zero at 1e-4 Pa</span>
<span class="n">pres_o3_t0_add_top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pres_o3_t0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_o3_t0</span><span class="p">),</span><span class="mf">0.0001</span><span class="p">)</span>
<span class="n">o3_t0_add_top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">o3_t0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">o3_t0</span><span class="p">),</span><span class="mf">0.0</span><span class="p">)</span>

<span class="c1"># Add bottom pressure and o3 value - here we assume o3 is constant near the sfc</span>
<span class="n">pres_o3_t0_add_top_bottom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pres_o3_t0_add_top</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">pres_t0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">o3_t0_add_top_bottom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">o3_t0_add_top</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">o3_t0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Do the extrapolation</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">pres_o3_t0_add_top_bottom</span><span class="p">,</span> <span class="n">o3_t0_add_top_bottom</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)</span>
<span class="n">o3_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">pres_t0</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">o3_t0</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">o3_t0i</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">,</span><span class="n">pres_o3_t0</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">,</span><span class="n">pres_t0</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Extrapolated profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Ozone (kg kg-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure (Pa)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/8c9f6146fede7f3591789241cfef3f1b2008204fbccb20a1eca1735df1834290.png" src="../../_images/8c9f6146fede7f3591789241cfef3f1b2008204fbccb20a1eca1735df1834290.png" />
</div>
</div>
</section>
<section id="get-geostrophic-wind-forcing">
<h2>Get Geostrophic wind forcing<a class="headerlink" href="#get-geostrophic-wind-forcing" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">do_geo</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># TEMPORARY FLAG</span>
<span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="c1"># Read ERA5 file</span>
    <span class="n">era5_geo_file</span> <span class="o">=</span> <span class="s1">&#39;/glade/scratch/tjuliano/doe_comble/wrf_asr_cao/WRF-ASR-CAO/scripts/era5/era5_mar13_case_larger.nc&#39;</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">era5_geo_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>

    <span class="n">zl</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">][</span><span class="mi">24</span><span class="o">-</span><span class="n">t0_h</span><span class="p">:</span><span class="mi">43</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,:,:]</span> <span class="c1"># time, lev, lat, lon</span>
    <span class="n">lonarrl</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">][:]</span>
    <span class="n">latarrl</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">][:]</span>

    <span class="n">latloc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">lonloc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">ugl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">zl</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">vgl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">zl</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">zhtl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">zl</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>

    <span class="n">omega</span> <span class="o">=</span> <span class="mf">7.2921e-5</span> <span class="c1"># angular velocity</span>
    <span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c1"># grav constant</span>
    <span class="n">min_dx</span> <span class="o">=</span> <span class="mf">20.</span> <span class="c1"># minimum grid spacing (km) for discretization</span>
    <span class="n">min_dy</span> <span class="o">=</span> <span class="mf">20.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">)):</span>
        <span class="n">hold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">latarrl</span><span class="p">)</span>
        <span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">hold</span><span class="p">)</span>
        <span class="n">hold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">les_lon2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">lonarrl</span><span class="p">)</span>   
        <span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">hold</span><span class="p">)</span>

        <span class="c1"># Coriolis parameter</span>
        <span class="n">e</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="c1"># Calc dx, dy</span>
        <span class="n">offset1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">offset2</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">coords_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset2</span><span class="p">])</span>
        <span class="n">coords_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset2</span><span class="p">])</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">geopy</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">geodesic</span><span class="p">(</span><span class="n">coords_1</span><span class="p">,</span> <span class="n">coords_2</span><span class="p">)</span><span class="o">.</span><span class="n">km</span>
        <span class="n">coords_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset1</span><span class="p">],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">coords_4</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset1</span><span class="p">],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">geopy</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">geodesic</span><span class="p">(</span><span class="n">coords_3</span><span class="p">,</span> <span class="n">coords_4</span><span class="p">)</span><span class="o">.</span><span class="n">km</span>
        <span class="k">while</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="n">min_dx</span><span class="p">:</span> <span class="c1"># we want at least min_dx km for our zonal discretization, which changes with time (latitude)</span>
            <span class="n">offset2</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">coords_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset2</span><span class="p">])</span>
            <span class="n">coords_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset2</span><span class="p">])</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">geopy</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">geodesic</span><span class="p">(</span><span class="n">coords_1</span><span class="p">,</span> <span class="n">coords_2</span><span class="p">)</span><span class="o">.</span><span class="n">km</span>
        <span class="k">while</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="n">min_dy</span><span class="p">:</span> <span class="c1"># we want at least min_dy km for our meridional discretization, which stays mostly constant with time (latitude)</span>
            <span class="n">offset1</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">coords_3</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset1</span><span class="p">],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">coords_4</span> <span class="o">=</span> <span class="p">(</span><span class="n">latarrl</span><span class="p">[</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset1</span><span class="p">],</span> <span class="n">lonarrl</span><span class="p">[</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">geopy</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">geodesic</span><span class="p">(</span><span class="n">coords_3</span><span class="p">,</span> <span class="n">coords_4</span><span class="p">)</span><span class="o">.</span><span class="n">km</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="mf">1000.</span> <span class="c1"># km to m</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="mf">1000.</span>

        <span class="c1"># Calc Vg</span>
        <span class="n">ugl</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">zl</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset1</span><span class="p">,</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">-</span><span class="n">zl</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset1</span><span class="p">,</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">/</span><span class="n">dy</span>
        <span class="n">vgl</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">f</span><span class="p">)</span>  <span class="o">*</span> <span class="p">(</span><span class="n">zl</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">offset2</span><span class="p">]</span><span class="o">-</span><span class="n">zl</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">offset2</span><span class="p">])</span><span class="o">/</span><span class="n">dx</span>
        <span class="n">zhtl</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">zl</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="n">latloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lonloc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">/</span><span class="n">g</span>

    <span class="n">ugeo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">ugl</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">vgeo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">vgl</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">zgeo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">zhtl</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ugeo</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">ugeo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">vgeo</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">vgeo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Geostrophic wind computed&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Geostrophic wind computed
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpolate-extrapolate-ug-vg-to-native-era5-levels">
<h2>Interpolate/extrapolate Ug/Vg to native ERA5 levels<a class="headerlink" href="#interpolate-extrapolate-ug-vg-to-native-era5-levels" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ugeo_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ugeo</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">hgt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">vgeo_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ugeo</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">hgt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">zgeo_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ugeo</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">hgt</span><span class="p">)[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_lat2</span><span class="p">)):</span>
        <span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">zgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">ugeo</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)</span>
        <span class="n">ugeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">zgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">vgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;extrapolate&#39;</span><span class="p">)</span>
        <span class="n">vgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpolate-t0-profiles-nudging-profiles-and-geostrophic-wind-profiles-to-common-vertical-grid-for-simplicity">
<h2>Interpolate t0 profiles, nudging profiles, and geostrophic wind profiles to common vertical grid for simplicity<a class="headerlink" href="#interpolate-t0-profiles-nudging-profiles-and-geostrophic-wind-profiles-to-common-vertical-grid-for-simplicity" title="Permalink to this heading">#</a></h2>
<section id="find-time-with-highest-first-level-and-get-vertical-grid">
<h3>Find time with highest first level and get vertical grid<a class="headerlink" href="#find-time-with-highest-first-level-and-get-vertical-grid" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">zz1_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">zz1_geo</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">zz1_nudge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>

        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">zz1_geo_max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">zz1_geo</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">zz1_nudge_max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">zz1_nudge</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">zz1_geo_max</span> <span class="o">=</span> <span class="n">zz1_geo</span><span class="p">[</span><span class="n">zz1_geo_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">zz1_nudge_max</span> <span class="o">=</span> <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">zz1_nudge_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">zz1_geo_max</span> <span class="o">&gt;</span> <span class="n">zz1_nudge_max</span><span class="p">:</span>
        <span class="n">zgeoi</span> <span class="o">=</span> <span class="n">zz1_geo</span><span class="p">[</span><span class="n">zz1_geo_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">zgeoi</span> <span class="o">=</span> <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">zz1_nudge_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
<span class="k">else</span><span class="p">:</span>
    <span class="n">zz1_nudge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:]</span>

        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>

    <span class="n">zz1_nudge_max_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">zz1_nudge</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">zz1_nudge_max</span> <span class="o">=</span> <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">zz1_nudge_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">zgeoi</span> <span class="o">=</span> <span class="n">zz1_nudge</span><span class="p">[</span><span class="n">zz1_nudge_max_idx</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;First level for all profiles = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; m&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First level for all profiles = 18.168 m
</pre></div>
</div>
</div>
</div>
</section>
<section id="do-the-linear-interpolation-of-time-varying-geostrophic-profiles-to-new-vertical-grid">
<h3>Do the linear interpolation of time-varying geostrophic profiles to new vertical grid<a class="headerlink" href="#do-the-linear-interpolation-of-time-varying-geostrophic-profiles-to-new-vertical-grid" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ugeoi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">vgeoi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">ugeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
        <span class="n">ugeoi</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">zgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span> <span class="n">vgeo_new</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
        <span class="n">vgeoi</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>

        <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-original-and-interpolated-profiles-of-time-varying-geostrophic-wind-as-example-to-show-efficacy-of-method">
<h3>Compare original and interpolated profiles of time-varying geostrophic wind as example to show efficacy of method<a class="headerlink" href="#compare-original-and-interpolated-profiles-of-time-varying-geostrophic-wind-as-example-to-show-efficacy-of-method" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="n">nhrs</span><span class="o">-</span><span class="mi">3</span>
<span class="n">zplt2b</span> <span class="o">=</span> <span class="mi">50</span>

<span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">ugeo</span>
    <span class="n">var_plt2</span> <span class="o">=</span> <span class="n">ugeoi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U$_</span><span class="si">{g}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>

    <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vgeo</span>
    <span class="n">var_plt2</span> <span class="o">=</span> <span class="n">vgeoi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original profile&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated profile&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeo</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V$_</span><span class="si">{g}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/7eabb793246d27470bdecb3472c96939cedb40daa8605aa627d2c7545781e895.png" src="../../_images/7eabb793246d27470bdecb3472c96939cedb40daa8605aa627d2c7545781e895.png" />
</div>
</div>
</section>
<section id="do-the-linear-interpolation-for-initial-forcing-profiles">
<h3>Do the linear interpolation for initial forcing profiles<a class="headerlink" href="#do-the-linear-interpolation-for-initial-forcing-profiles" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">pres_t0</span><span class="p">)</span>
<span class="n">pres_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">uwnd_t0</span><span class="p">)</span>
<span class="n">uwnd_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">vwnd_t0</span><span class="p">)</span>
<span class="n">vwnd_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">wwnd_t0</span><span class="p">)</span>
<span class="n">wwnd_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">temp_t0</span><span class="p">)</span>
<span class="n">temp_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">theta_t0</span><span class="p">)</span>
<span class="n">theta_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">qv_t0</span><span class="p">)</span>
<span class="n">qv_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt_t0</span><span class="p">,</span> <span class="n">o3_t0i</span><span class="p">)</span>
<span class="n">o3_t0i</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="do-the-linear-interpolation-for-nudging-forcing-profiles">
<h3>Do the linear interpolation for nudging forcing profiles<a class="headerlink" href="#do-the-linear-interpolation-for-nudging-forcing-profiles" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unudgei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">vnudgei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">do_t_qv_w</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># temp flag for advection checks</span>
<span class="k">if</span> <span class="n">do_t_qv_w</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">tnudgei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">qvnudgei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">wnudgei</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="n">nhrs</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pres_t0</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span> <span class="n">uwnd</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:])</span>
    <span class="n">unudgei</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span> <span class="n">vwnd</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:])</span>
    <span class="n">vnudgei</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">do_t_qv_w</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span> <span class="n">theta</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:])</span>
        <span class="n">tnudgei</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
        
        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span> <span class="n">qv</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:])</span>
        <span class="n">qvnudgei</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
        
        <span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:],</span> <span class="n">wwnd</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">z1</span><span class="p">:])</span>
        <span class="n">wnudgei</span><span class="p">[</span><span class="n">count</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
    
    <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-original-and-interpolated-profiles-of-time-varying-nudging-wind-as-example-to-show-efficacy-of-method">
<h3>Compare original and interpolated profiles of time-varying nudging wind as example to show efficacy of method<a class="headerlink" href="#compare-original-and-interpolated-profiles-of-time-varying-nudging-wind-as-example-to-show-efficacy-of-method" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="n">nhrs</span><span class="o">-</span><span class="mi">3</span>
<span class="n">zplt2b</span> <span class="o">=</span> <span class="mi">50</span>

<span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

    <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">uwnd</span>
    <span class="n">var_plt2</span> <span class="o">=</span> <span class="n">unudgei</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>

    <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vwnd</span>
    <span class="n">var_plt2</span> <span class="o">=</span> <span class="n">vnudgei</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original profile&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated profile&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2b</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/f86e3195a5df071ac5e046edf8cf8ed9d35f36bb62653493760b8417ee953fa4.png" src="../../_images/f86e3195a5df071ac5e046edf8cf8ed9d35f36bb62653493760b8417ee953fa4.png" />
</div>
</div>
</section>
<section id="compare-original-and-interpolated-intial-profiles-as-example-to-show-efficacy-of-method">
<h3>Compare original and interpolated intial profiles as example to show efficacy of method<a class="headerlink" href="#compare-original-and-interpolated-intial-profiles-as-example-to-show-efficacy-of-method" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">uwnd_t0</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">uwnd_t0i</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt_t0</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U-wind (m s-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>

<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vwnd_t0</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">vwnd_t0i</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt_t0</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V-wind (m s-1)&#39;</span><span class="p">)</span>
        
<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">theta_t0</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">theta_t0i</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt_t0</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated profile&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Potential Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/bc169d9135d76e256750c274e74c26271abee14bce84035393f8732736ff8c2b.png" src="../../_images/bc169d9135d76e256750c274e74c26271abee14bce84035393f8732736ff8c2b.png" />
</div>
</div>
</section>
<section id="compare-original-and-interpolated-nudging-profiles-as-example-to-show-efficacy-of-method">
<h3>Compare original and interpolated nudging profiles as example to show efficacy of method<a class="headerlink" href="#compare-original-and-interpolated-nudging-profiles-as-example-to-show-efficacy-of-method" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">uwnd</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">unudgei</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U-wind (m s-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>
        
<span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vwnd</span>
<span class="n">var_plt2</span> <span class="o">=</span> <span class="n">vnudgei</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original profile&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated profile&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">hgt</span><span class="p">[</span><span class="n">t0</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">zplt2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V-wind (m s-1)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 432x288 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../../_images/4ab496e6e3a7268056e89a6d0e45eac737de046a6e62381103fd3b6a495d872c.png" src="../../_images/4ab496e6e3a7268056e89a6d0e45eac737de046a6e62381103fd3b6a495d872c.png" />
</div>
</div>
</section>
<section id="id1">
<h3>Compare original and interpolated nudging profiles as example to show efficacy of method<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">nhrs_plt</span> <span class="o">=</span> <span class="mi">19</span>

<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nhrs_plt</span><span class="p">))</span>

<span class="n">lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>

<span class="n">print_figs</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">tnudgei</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">unudgei</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vnudgei</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs_plt</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Potential Temperature (K)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">245</span><span class="p">,</span><span class="mi">275</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_figs</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ptemp_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;uwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d7a61018a5921137b5406b3642986f246f8f3dea989fb1446c78c1a4a191281.png" src="../../_images/6d7a61018a5921137b5406b3642986f246f8f3dea989fb1446c78c1a4a191281.png" />
<img alt="../../_images/4a011658aafde881a237a7903a80c500d357be42edc11a79a6bebadadf24fcb1.png" src="../../_images/4a011658aafde881a237a7903a80c500d357be42edc11a79a6bebadadf24fcb1.png" />
<img alt="../../_images/d329099a541aca229b8890b68ffc67eeaf42db54410a546811f3602672617bb9.png" src="../../_images/d329099a541aca229b8890b68ffc67eeaf42db54410a546811f3602672617bb9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zplt1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">zplt2</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">nhrs_plt</span> <span class="o">=</span> <span class="mi">19</span>

<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">cmocean</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">balance</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nhrs_plt</span><span class="p">))</span>

<span class="n">lab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>

<span class="n">print_figs</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">tnudgei</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">ugeoi</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vgeoi</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs_plt</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Potential Temperature (K)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U$</span><span class="si">{g}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V$</span><span class="si">{g}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">245</span><span class="p">,</span><span class="mi">275</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_figs</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ptemp_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;uwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d7a61018a5921137b5406b3642986f246f8f3dea989fb1446c78c1a4a191281.png" src="../../_images/6d7a61018a5921137b5406b3642986f246f8f3dea989fb1446c78c1a4a191281.png" />
<img alt="../../_images/5b69a8abf2938c0c5ba687d319ad1f4cb8f058fc9c134084835e06b42dac8665.png" src="../../_images/5b69a8abf2938c0c5ba687d319ad1f4cb8f058fc9c134084835e06b42dac8665.png" />
<img alt="../../_images/db8206d882e37ce31349ef53029f1bd3de74aa532ab8e535f943540cfa8d347b.png" src="../../_images/db8206d882e37ce31349ef53029f1bd3de74aa532ab8e535f943540cfa8d347b.png" />
</div>
</div>
</section>
<section id="compute-ageostrophic-winds">
<h3>Compute ageostrophic winds<a class="headerlink" href="#compute-ageostrophic-winds" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_figs</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">unudgei</span> <span class="o">-</span> <span class="n">ugeoi</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">vnudgei</span> <span class="o">-</span> <span class="n">vgeoi</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">nudge_wspd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">unudgei</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">vnudgei</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">geo_wspd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">ugeoi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">vgeoi</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1">#var_plt1 = nudge_wspd - geo_wspd</span>
        <span class="n">var_plt1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">unudgei</span> <span class="o">-</span> <span class="n">ugeoi</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">vnudgei</span> <span class="o">-</span> <span class="n">vgeoi</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs_plt</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">var_plt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">zgeoi</span><span class="p">[</span><span class="n">zplt1</span><span class="p">:</span><span class="n">zplt2</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">lab</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;u$_</span><span class="si">{ag}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;v$_</span><span class="si">{ag}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;V$_</span><span class="si">{ag}</span><span class="s1">$-wind (m s-1)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height ASL (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">print_figs</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;uagwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;vagwnd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ageownd_time_height.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9650560952d9525e2f814ead43c2bfccddecb5870dbd88813d852ec1b821baca.png" src="../../_images/9650560952d9525e2f814ead43c2bfccddecb5870dbd88813d852ec1b821baca.png" />
<img alt="../../_images/10d031e213ee8d0ee4386dbf17d9f8d49332a658cbfafecd4c305223580ef287.png" src="../../_images/10d031e213ee8d0ee4386dbf17d9f8d49332a658cbfafecd4c305223580ef287.png" />
<img alt="../../_images/c4d7dec7e2d5d230a403a146f461ee6b46161038f8dabfe09e1f1b969e2a6cdd.png" src="../../_images/c4d7dec7e2d5d230a403a146f461ee6b46161038f8dabfe09e1f1b969e2a6cdd.png" />
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="do-sfc-forcing">
<h1>DO SFC FORCING<a class="headerlink" href="#do-sfc-forcing" title="Permalink to this heading">#</a></h1>
<section id="calculate-sea-ice-concentration-along-trajectory">
<h2>Calculate sea ice concentration along trajectory<a class="headerlink" href="#calculate-sea-ice-concentration-along-trajectory" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sic_file</span> <span class="o">=</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;Svalbard_asi-AMSR2-n10m-20200313_m.nc&#39;</span><span class="p">)</span>
<span class="n">sic</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">][:,:]</span>
<span class="n">sic_lat</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
<span class="n">sic_lon</span> <span class="o">=</span> <span class="n">sic_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>

<span class="n">sic_traj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_hh_idx</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">les_hh_idx</span><span class="p">)):</span>
    <span class="n">abslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sic_lat</span><span class="o">-</span><span class="n">les_lat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">abslon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sic_lon</span><span class="o">-</span><span class="n">les_lon</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">jlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">abslat</span><span class="p">)</span>
    <span class="n">ilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">abslon</span><span class="p">)</span>
    <span class="c1">#print (les_lat[i],les_lon[i])</span>
    <span class="c1">#print (jlat,ilon)</span>
    <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sic</span><span class="p">[</span><span class="n">jlat</span><span class="p">,</span><span class="n">ilon</span><span class="p">]</span>
    <span class="c1">#print (les_lat_hr[i],les_lon_hr[i],les_hh_hr[les_hh_hr_idx[i]],sic_traj[i])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-time-series-information-for-sfc-forcing">
<h2>Get time series information for sfc forcing<a class="headerlink" href="#get-time-series-information-for-sfc-forcing" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate SST</span>
<span class="n">tmp_hh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">t0_h</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># these are the hours we have SST data from the ERA5 backward trajectory file</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">tmp_hh</span><span class="p">,</span> <span class="n">sst</span><span class="p">[</span><span class="n">t0</span><span class="p">:])</span>
<span class="n">sst_interp</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">les_hh</span><span class="p">[</span><span class="n">les_hh_idx</span><span class="p">])</span>
<span class="c1">#print (sst_interp)</span>

<span class="c1"># Modification for over ice/MIZ</span>
<span class="n">tsk_ice</span> <span class="o">=</span> <span class="mf">247.0</span>
<span class="n">sst_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">)):</span>
    <span class="c1">#if t0_h == 10:</span>
    <span class="c1">#    if i == 0:</span>
    <span class="c1">#        # Insert first position since backward trajectory file does not have t=0 (-28h)</span>
    <span class="c1">#        sst_ts[i] = tsk_ice</span>
    <span class="c1">#        print (&#39;Computed TSK for hour &#39; + str(round(5*i/60.,3)) + &#39;: &#39; + str(round(sst_ts[i],3)))</span>
    <span class="k">if</span> <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">90.0</span><span class="p">:</span> <span class="c1"># over ice</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tsk_ice</span>
    <span class="k">elif</span> <span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span> <span class="c1"># MIZ</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span><span class="o">*</span><span class="n">tsk_ice</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">))</span><span class="o">*</span><span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># MIZ</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># open ocean</span>
        <span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1">#if t0_h == 10:</span>
    <span class="c1">#    # Do some printing magic</span>
    <span class="c1">#    print (&#39;Computed TSK for hour &#39; + str(round(5/60.+5*i/60.,3)) + &#39;: &#39;</span>
    <span class="c1">#           + str(round(sst_ts[i],3)) + &#39; with SIC = &#39; + str(sic_traj[i]/100.) +</span>
    <span class="c1">#           &#39; and SST = &#39; + str(round(sst_interp[i],3)))</span>
    <span class="c1">#else:</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Computed TSK for hour &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mf">60.</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span>
           <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sst_ts</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; with SIC = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sic_traj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">100.</span><span class="p">)</span> <span class="o">+</span>
           <span class="s1">&#39; and SST = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sst_interp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Pull hourly SST</span>
<span class="n">sst_ts</span> <span class="o">=</span> <span class="n">sst_ts</span><span class="p">[::</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computed TSK for hour 0.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.167: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.25: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.333: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 0.75: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.833: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 0.917: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.0: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 1.583: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 1.667: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 1.75: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 1.833: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 1.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.083: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.167: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 2.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 2.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 2.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 2.5: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.583: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.667: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.75: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.833: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 2.917: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.0: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 3.083: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 3.167: 247.0 with SIC = 0.96 and SST = 271.46
Computed TSK for hour 3.25: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.417: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 3.583: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 3.667: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 3.75: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 3.833: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 3.917: 247.0 with SIC = 1.0 and SST = 271.46
Computed TSK for hour 4.0: 247.0 with SIC = 0.97 and SST = 271.46
Computed TSK for hour 4.083: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.167: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.25: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.333: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.417: 247.0 with SIC = 0.99 and SST = 271.46
Computed TSK for hour 4.5: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.583: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.667: 247.0 with SIC = 0.98 and SST = 271.46
Computed TSK for hour 4.75: 247.0 with SIC = 0.95 and SST = 271.46
Computed TSK for hour 4.833: 247.0 with SIC = 0.95 and SST = 271.46
Computed TSK for hour 4.917: 249.935 with SIC = 0.88 and SST = 271.46
Computed TSK for hour 5.0: 249.935 with SIC = 0.88 and SST = 271.46
Computed TSK for hour 5.083: 247.0 with SIC = 0.95 and SST = 271.652
Computed TSK for hour 5.167: 247.0 with SIC = 0.95 and SST = 271.844
Computed TSK for hour 5.25: 263.774 with SIC = 0.33 and SST = 272.035
Computed TSK for hour 5.333: 263.902 with SIC = 0.33 and SST = 272.227
Computed TSK for hour 5.417: 264.031 with SIC = 0.33 and SST = 272.419
Computed TSK for hour 5.5: 265.184 with SIC = 0.29 and SST = 272.611
Computed TSK for hour 5.583: 265.32 with SIC = 0.29 and SST = 272.803
Computed TSK for hour 5.667: 269.615 with SIC = 0.13 and SST = 272.994
Computed TSK for hour 5.75: 269.782 with SIC = 0.13 and SST = 273.186
Computed TSK for hour 5.833: 271.004 with SIC = 0.09 and SST = 273.378
Computed TSK for hour 5.917: 268.256 with SIC = 0.2 and SST = 273.57
Computed TSK for hour 6.0: 271.086 with SIC = 0.1 and SST = 273.762
Computed TSK for hour 6.083: 271.207 with SIC = 0.1 and SST = 273.897
Computed TSK for hour 6.167: 271.329 with SIC = 0.1 and SST = 274.032
Computed TSK for hour 6.25: 274.167 with SIC = 0.0 and SST = 274.167
Computed TSK for hour 6.333: 274.302 with SIC = 0.0 and SST = 274.302
Computed TSK for hour 6.417: 274.437 with SIC = 0.0 and SST = 274.437
Computed TSK for hour 6.5: 274.572 with SIC = 0.0 and SST = 274.572
Computed TSK for hour 6.583: 274.707 with SIC = 0.0 and SST = 274.707
Computed TSK for hour 6.667: 274.842 with SIC = 0.0 and SST = 274.842
Computed TSK for hour 6.75: 274.978 with SIC = 0.0 and SST = 274.978
Computed TSK for hour 6.833: 275.113 with SIC = 0.0 and SST = 275.113
Computed TSK for hour 6.917: 275.248 with SIC = 0.0 and SST = 275.248
Computed TSK for hour 7.0: 275.383 with SIC = 0.0 and SST = 275.383
Computed TSK for hour 7.083: 275.366 with SIC = 0.0 and SST = 275.366
Computed TSK for hour 7.167: 275.349 with SIC = 0.0 and SST = 275.349
Computed TSK for hour 7.25: 275.333 with SIC = 0.0 and SST = 275.333
Computed TSK for hour 7.333: 275.316 with SIC = 0.0 and SST = 275.316
Computed TSK for hour 7.417: 275.299 with SIC = 0.0 and SST = 275.299
Computed TSK for hour 7.5: 275.282 with SIC = 0.0 and SST = 275.282
Computed TSK for hour 7.583: 275.265 with SIC = 0.0 and SST = 275.265
Computed TSK for hour 7.667: 275.249 with SIC = 0.0 and SST = 275.249
Computed TSK for hour 7.75: 275.232 with SIC = 0.0 and SST = 275.232
Computed TSK for hour 7.833: 275.215 with SIC = 0.0 and SST = 275.215
Computed TSK for hour 7.917: 275.198 with SIC = 0.0 and SST = 275.198
Computed TSK for hour 8.0: 275.182 with SIC = 0.0 and SST = 275.182
Computed TSK for hour 8.083: 275.205 with SIC = 0.0 and SST = 275.205
Computed TSK for hour 8.167: 275.228 with SIC = 0.0 and SST = 275.228
Computed TSK for hour 8.25: 275.251 with SIC = 0.0 and SST = 275.251
Computed TSK for hour 8.333: 275.275 with SIC = 0.0 and SST = 275.275
Computed TSK for hour 8.417: 275.298 with SIC = 0.0 and SST = 275.298
Computed TSK for hour 8.5: 275.321 with SIC = 0.0 and SST = 275.321
Computed TSK for hour 8.583: 275.345 with SIC = 0.0 and SST = 275.345
Computed TSK for hour 8.667: 275.368 with SIC = 0.0 and SST = 275.368
Computed TSK for hour 8.75: 275.391 with SIC = 0.0 and SST = 275.391
Computed TSK for hour 8.833: 275.414 with SIC = 0.0 and SST = 275.414
Computed TSK for hour 8.917: 275.438 with SIC = 0.0 and SST = 275.438
Computed TSK for hour 9.0: 275.461 with SIC = 0.0 and SST = 275.461
Computed TSK for hour 9.083: 275.489 with SIC = 0.0 and SST = 275.489
Computed TSK for hour 9.167: 275.518 with SIC = 0.0 and SST = 275.518
Computed TSK for hour 9.25: 275.546 with SIC = 0.0 and SST = 275.546
Computed TSK for hour 9.333: 275.575 with SIC = 0.0 and SST = 275.575
Computed TSK for hour 9.417: 275.603 with SIC = 0.0 and SST = 275.603
Computed TSK for hour 9.5: 275.632 with SIC = 0.0 and SST = 275.632
Computed TSK for hour 9.583: 275.66 with SIC = 0.0 and SST = 275.66
Computed TSK for hour 9.667: 275.689 with SIC = 0.0 and SST = 275.689
Computed TSK for hour 9.75: 275.717 with SIC = 0.0 and SST = 275.717
Computed TSK for hour 9.833: 275.746 with SIC = 0.0 and SST = 275.746
Computed TSK for hour 9.917: 275.774 with SIC = 0.0 and SST = 275.774
Computed TSK for hour 10.0: 275.803 with SIC = 0.0 and SST = 275.803
Computed TSK for hour 10.083: 275.841 with SIC = 0.0 and SST = 275.841
Computed TSK for hour 10.167: 275.88 with SIC = 0.0 and SST = 275.88
Computed TSK for hour 10.25: 275.918 with SIC = 0.0 and SST = 275.918
Computed TSK for hour 10.333: 275.956 with SIC = 0.0 and SST = 275.956
Computed TSK for hour 10.417: 275.995 with SIC = 0.0 and SST = 275.995
Computed TSK for hour 10.5: 276.033 with SIC = 0.0 and SST = 276.033
Computed TSK for hour 10.583: 276.072 with SIC = 0.0 and SST = 276.072
Computed TSK for hour 10.667: 276.11 with SIC = 0.0 and SST = 276.11
Computed TSK for hour 10.75: 276.148 with SIC = 0.0 and SST = 276.148
Computed TSK for hour 10.833: 276.187 with SIC = 0.0 and SST = 276.187
Computed TSK for hour 10.917: 276.225 with SIC = 0.0 and SST = 276.225
Computed TSK for hour 11.0: 276.264 with SIC = 0.0 and SST = 276.264
Computed TSK for hour 11.083: 276.288 with SIC = 0.0 and SST = 276.288
Computed TSK for hour 11.167: 276.313 with SIC = 0.0 and SST = 276.313
Computed TSK for hour 11.25: 276.338 with SIC = 0.0 and SST = 276.338
Computed TSK for hour 11.333: 276.362 with SIC = 0.0 and SST = 276.362
Computed TSK for hour 11.417: 276.387 with SIC = 0.0 and SST = 276.387
Computed TSK for hour 11.5: 276.412 with SIC = 0.0 and SST = 276.412
Computed TSK for hour 11.583: 276.436 with SIC = 0.0 and SST = 276.436
Computed TSK for hour 11.667: 276.461 with SIC = 0.0 and SST = 276.461
Computed TSK for hour 11.75: 276.486 with SIC = 0.0 and SST = 276.486
Computed TSK for hour 11.833: 276.51 with SIC = 0.0 and SST = 276.51
Computed TSK for hour 11.917: 276.535 with SIC = 0.0 and SST = 276.535
Computed TSK for hour 12.0: 276.56 with SIC = 0.0 and SST = 276.56
Computed TSK for hour 12.083: 276.578 with SIC = 0.0 and SST = 276.578
Computed TSK for hour 12.167: 276.596 with SIC = 0.0 and SST = 276.596
Computed TSK for hour 12.25: 276.614 with SIC = 0.0 and SST = 276.614
Computed TSK for hour 12.333: 276.632 with SIC = 0.0 and SST = 276.632
Computed TSK for hour 12.417: 276.65 with SIC = 0.0 and SST = 276.65
Computed TSK for hour 12.5: 276.668 with SIC = 0.0 and SST = 276.668
Computed TSK for hour 12.583: 276.687 with SIC = 0.0 and SST = 276.687
Computed TSK for hour 12.667: 276.705 with SIC = 0.0 and SST = 276.705
Computed TSK for hour 12.75: 276.723 with SIC = 0.0 and SST = 276.723
Computed TSK for hour 12.833: 276.741 with SIC = 0.0 and SST = 276.741
Computed TSK for hour 12.917: 276.759 with SIC = 0.0 and SST = 276.759
Computed TSK for hour 13.0: 276.777 with SIC = 0.0 and SST = 276.777
Computed TSK for hour 13.083: 276.821 with SIC = 0.0 and SST = 276.821
Computed TSK for hour 13.167: 276.864 with SIC = 0.0 and SST = 276.864
Computed TSK for hour 13.25: 276.908 with SIC = 0.0 and SST = 276.908
Computed TSK for hour 13.333: 276.951 with SIC = 0.0 and SST = 276.951
Computed TSK for hour 13.417: 276.995 with SIC = 0.0 and SST = 276.995
Computed TSK for hour 13.5: 277.039 with SIC = 0.0 and SST = 277.039
Computed TSK for hour 13.583: 277.082 with SIC = 0.0 and SST = 277.082
Computed TSK for hour 13.667: 277.126 with SIC = 0.0 and SST = 277.126
Computed TSK for hour 13.75: 277.169 with SIC = 0.0 and SST = 277.169
Computed TSK for hour 13.833: 277.213 with SIC = 0.0 and SST = 277.213
Computed TSK for hour 13.917: 277.256 with SIC = 0.0 and SST = 277.256
Computed TSK for hour 14.0: 277.3 with SIC = 0.0 and SST = 277.3
Computed TSK for hour 14.083: 277.345 with SIC = 0.0 and SST = 277.345
Computed TSK for hour 14.167: 277.391 with SIC = 0.0 and SST = 277.391
Computed TSK for hour 14.25: 277.436 with SIC = 0.0 and SST = 277.436
Computed TSK for hour 14.333: 277.481 with SIC = 0.0 and SST = 277.481
Computed TSK for hour 14.417: 277.527 with SIC = 0.0 and SST = 277.527
Computed TSK for hour 14.5: 277.572 with SIC = 0.0 and SST = 277.572
Computed TSK for hour 14.583: 277.618 with SIC = 0.0 and SST = 277.618
Computed TSK for hour 14.667: 277.663 with SIC = 0.0 and SST = 277.663
Computed TSK for hour 14.75: 277.708 with SIC = 0.0 and SST = 277.708
Computed TSK for hour 14.833: 277.754 with SIC = 0.0 and SST = 277.754
Computed TSK for hour 14.917: 277.799 with SIC = 0.0 and SST = 277.799
Computed TSK for hour 15.0: 277.845 with SIC = 0.0 and SST = 277.845
Computed TSK for hour 15.083: 277.856 with SIC = 0.0 and SST = 277.856
Computed TSK for hour 15.167: 277.868 with SIC = 0.0 and SST = 277.868
Computed TSK for hour 15.25: 277.879 with SIC = 0.0 and SST = 277.879
Computed TSK for hour 15.333: 277.89 with SIC = 0.0 and SST = 277.89
Computed TSK for hour 15.417: 277.902 with SIC = 0.0 and SST = 277.902
Computed TSK for hour 15.5: 277.913 with SIC = 0.0 and SST = 277.913
Computed TSK for hour 15.583: 277.924 with SIC = 0.0 and SST = 277.924
Computed TSK for hour 15.667: 277.936 with SIC = 0.0 and SST = 277.936
Computed TSK for hour 15.75: 277.947 with SIC = 0.0 and SST = 277.947
Computed TSK for hour 15.833: 277.959 with SIC = 0.0 and SST = 277.959
Computed TSK for hour 15.917: 277.97 with SIC = 0.0 and SST = 277.97
Computed TSK for hour 16.0: 277.981 with SIC = 0.0 and SST = 277.981
Computed TSK for hour 16.083: 277.998 with SIC = 0.0 and SST = 277.998
Computed TSK for hour 16.167: 278.014 with SIC = 0.0 and SST = 278.014
Computed TSK for hour 16.25: 278.031 with SIC = 0.0 and SST = 278.031
Computed TSK for hour 16.333: 278.047 with SIC = 0.0 and SST = 278.047
Computed TSK for hour 16.417: 278.063 with SIC = 0.0 and SST = 278.063
Computed TSK for hour 16.5: 278.08 with SIC = 0.0 and SST = 278.08
Computed TSK for hour 16.583: 278.096 with SIC = 0.0 and SST = 278.096
Computed TSK for hour 16.667: 278.112 with SIC = 0.0 and SST = 278.112
Computed TSK for hour 16.75: 278.129 with SIC = 0.0 and SST = 278.129
Computed TSK for hour 16.833: 278.145 with SIC = 0.0 and SST = 278.145
Computed TSK for hour 16.917: 278.161 with SIC = 0.0 and SST = 278.161
Computed TSK for hour 17.0: 278.178 with SIC = 0.0 and SST = 278.178
Computed TSK for hour 17.083: 278.208 with SIC = 0.0 and SST = 278.208
Computed TSK for hour 17.167: 278.238 with SIC = 0.0 and SST = 278.238
Computed TSK for hour 17.25: 278.269 with SIC = 0.0 and SST = 278.269
Computed TSK for hour 17.333: 278.299 with SIC = 0.0 and SST = 278.299
Computed TSK for hour 17.417: 278.329 with SIC = 0.0 and SST = 278.329
Computed TSK for hour 17.5: 278.359 with SIC = 0.0 and SST = 278.359
Computed TSK for hour 17.583: 278.39 with SIC = 0.0 and SST = 278.39
Computed TSK for hour 17.667: 278.42 with SIC = 0.0 and SST = 278.42
Computed TSK for hour 17.75: 278.45 with SIC = 0.0 and SST = 278.45
Computed TSK for hour 17.833: 278.48 with SIC = 0.0 and SST = 278.48
Computed TSK for hour 17.917: 278.511 with SIC = 0.0 and SST = 278.511
Computed TSK for hour 18.0: 278.541 with SIC = 0.0 and SST = 278.541
Computed TSK for hour 18.083: 278.592 with SIC = 0.0 and SST = 278.592
Computed TSK for hour 18.167: 278.642 with SIC = 0.0 and SST = 278.642
Computed TSK for hour 18.25: 278.693 with SIC = 0.0 and SST = 278.693
Computed TSK for hour 18.333: 278.744 with SIC = 0.0 and SST = 278.744
Computed TSK for hour 18.417: 278.795 with SIC = 0.0 and SST = 278.795
Computed TSK for hour 18.5: 278.845 with SIC = 0.0 and SST = 278.845
Computed TSK for hour 18.583: 278.896 with SIC = 0.0 and SST = 278.896
Computed TSK for hour 18.667: 278.947 with SIC = 0.0 and SST = 278.947
Computed TSK for hour 18.75: 278.997 with SIC = 0.0 and SST = 278.997
Computed TSK for hour 18.833: 279.048 with SIC = 0.0 and SST = 279.048
Computed TSK for hour 18.917: 279.099 with SIC = 0.0 and SST = 279.099
Computed TSK for hour 19.0: 279.149 with SIC = 0.0 and SST = 279.149
Computed TSK for hour 19.083: 279.169 with SIC = 0.0 and SST = 279.169
Computed TSK for hour 19.167: 279.188 with SIC = 0.0 and SST = 279.188
Computed TSK for hour 19.25: 279.207 with SIC = 0.0 and SST = 279.207
Computed TSK for hour 19.333: 279.227 with SIC = 0.0 and SST = 279.227
Computed TSK for hour 19.417: 279.246 with SIC = 0.0 and SST = 279.246
Computed TSK for hour 19.5: 279.265 with SIC = 0.0 and SST = 279.265
Computed TSK for hour 19.583: 279.284 with SIC = 0.0 and SST = 279.284
Computed TSK for hour 19.667: 279.304 with SIC = 0.0 and SST = 279.304
Computed TSK for hour 19.75: 279.323 with SIC = 0.0 and SST = 279.323
Computed TSK for hour 19.833: 279.342 with SIC = 0.0 and SST = 279.342
Computed TSK for hour 19.917: 279.362 with SIC = 0.0 and SST = 279.362
Computed TSK for hour 20.0: 279.381 with SIC = 0.0 and SST = 279.381
Computed TSK for hour 20.083: 279.385 with SIC = 0.0 and SST = 279.385
Computed TSK for hour 20.167: 279.39 with SIC = 0.0 and SST = 279.39
Computed TSK for hour 20.25: 279.394 with SIC = 0.0 and SST = 279.394
Computed TSK for hour 20.333: 279.399 with SIC = 0.0 and SST = 279.399
Computed TSK for hour 20.417: 279.403 with SIC = 0.0 and SST = 279.403
Computed TSK for hour 20.5: 279.408 with SIC = 0.0 and SST = 279.408
Computed TSK for hour 20.583: 279.412 with SIC = 0.0 and SST = 279.412
Computed TSK for hour 20.667: 279.417 with SIC = 0.0 and SST = 279.417
Computed TSK for hour 20.75: 279.421 with SIC = 0.0 and SST = 279.421
Computed TSK for hour 20.833: 279.426 with SIC = 0.0 and SST = 279.426
Computed TSK for hour 20.917: 279.43 with SIC = 0.0 and SST = 279.43
Computed TSK for hour 21.0: 279.435 with SIC = 0.0 and SST = 279.435
Computed TSK for hour 21.083: 279.425 with SIC = 0.0 and SST = 279.425
Computed TSK for hour 21.167: 279.416 with SIC = 0.0 and SST = 279.416
Computed TSK for hour 21.25: 279.407 with SIC = 0.0 and SST = 279.407
Computed TSK for hour 21.333: 279.397 with SIC = 0.0 and SST = 279.397
Computed TSK for hour 21.417: 279.388 with SIC = 0.0 and SST = 279.388
Computed TSK for hour 21.5: 279.379 with SIC = 0.0 and SST = 279.379
Computed TSK for hour 21.583: 279.37 with SIC = 0.0 and SST = 279.37
Computed TSK for hour 21.667: 279.36 with SIC = 0.0 and SST = 279.36
Computed TSK for hour 21.75: 279.351 with SIC = 0.0 and SST = 279.351
Computed TSK for hour 21.833: 279.342 with SIC = 0.0 and SST = 279.342
Computed TSK for hour 21.917: 279.333 with SIC = 0.0 and SST = 279.333
Computed TSK for hour 22.0: 279.323 with SIC = 0.0 and SST = 279.323
Computed TSK for hour 22.083: 279.195 with SIC = 0.0 and SST = 279.195
Computed TSK for hour 22.167: 279.068 with SIC = 0.0 and SST = 279.068
Computed TSK for hour 22.25: 278.94 with SIC = 0.0 and SST = 278.94
Computed TSK for hour 22.333: 278.812 with SIC = 0.0 and SST = 278.812
Computed TSK for hour 22.417: 278.684 with SIC = 0.0 and SST = 278.684
Computed TSK for hour 22.5: 278.557 with SIC = 0.0 and SST = 278.557
Computed TSK for hour 22.583: 278.429 with SIC = 0.0 and SST = 278.429
Computed TSK for hour 22.667: 278.301 with SIC = 0.0 and SST = 278.301
Computed TSK for hour 22.75: 278.173 with SIC = 0.0 and SST = 278.173
Computed TSK for hour 22.833: 278.046 with SIC = 0.0 and SST = 278.046
Computed TSK for hour 22.917: 277.918 with SIC = 0.0 and SST = 277.918
Computed TSK for hour 23.0: 277.79 with SIC = 0.0 and SST = 277.79
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-new-netcdf-file">
<h2>Create new netcdf file<a class="headerlink" href="#create-new-netcdf-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># just to be safe, make sure dataset is not already open.</span>
<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
<span class="n">ncfile</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="n">savename</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;NETCDF3_CLASSIC&#39;</span><span class="p">)</span> 
<span class="c1">#print(ncfile)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-dimensions">
<h2>Create dimensions<a class="headerlink" href="#create-dimensions" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">levs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zgeoi</span><span class="p">)</span>
<span class="c1">#levs_o3 = len(pres_t0_o3)</span>
<span class="n">z_grid_levs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z_grid</span><span class="p">)</span>
<span class="n">t0_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>     <span class="c1"># initial time axis</span>
<span class="n">lat_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>     <span class="c1"># latitude axis</span>
<span class="n">lon_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>     <span class="c1"># longitude axis</span>
<span class="n">lev_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span> <span class="n">levs</span><span class="p">)</span>      <span class="c1"># level axis</span>
<span class="c1">#pres_o3_dim = ncfile.createDimension(&#39;pres_o3&#39;, levs_o3)      # level axis for o3</span>
<span class="n">zw_grid_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;zw_grid&#39;</span><span class="p">,</span> <span class="n">z_grid_levs</span><span class="p">)</span>      <span class="c1"># zw_grid axis</span>
<span class="n">time_dim</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createDimension</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>    <span class="c1"># unlimited axis (can be appended to)</span>
<span class="c1">#for dim in ncfile.dimensions.items():</span>
<span class="c1">#    print(dim)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-global-attributes">
<h2>Create global attributes<a class="headerlink" href="#create-global-attributes" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncfile</span><span class="o">.</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Forcing and initial conditions for 13 March 2020 COMBLE intercomparison case&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">reference</span><span class="o">=</span><span class="s1">&#39;https://comble-intercomparison.readthedocs.io/en/latest/&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">authors</span><span class="o">=</span><span class="s1">&#39;Timothy W. Juliano (NCAR/RAL, tjuliano@ucar.edu); Florian Tornow (NASA/GISS, ft2544@columbia.edu); Ann M. Fridlind (NASA/GISS, ann.fridlind@nasa.gov)&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="s1">&#39;Created on 2023-06-01&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">format_version</span><span class="o">=</span><span class="s1">&#39;DEPHY SCM format version 2.0&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">script</span><span class="o">=</span><span class="s1">&#39;create_comble_forcing_v2.0.ipynb&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">startDate</span><span class="o">=</span><span class="n">start_time</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">endDate</span><span class="o">=</span><span class="s1">&#39;2020-03-13 18:00:00&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">force_geo</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">surfaceType</span><span class="o">=</span><span class="s1">&#39;ocean&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">surfaceForcing</span><span class="o">=</span><span class="s1">&#39;ts&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">lat</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">les_lat_mid</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; deg N&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dx</span><span class="o">=</span><span class="s1">&#39;150 m&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dy</span><span class="o">=</span><span class="s1">&#39;150 m&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">dz</span><span class="o">=</span><span class="s1">&#39;see zw_grid variable&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">nx</span><span class="o">=</span><span class="s1">&#39;648&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">ny</span><span class="o">=</span><span class="s1">&#39;648&#39;</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">nz</span><span class="o">=</span><span class="s1">&#39;160&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-variables">
<h2>Create variables<a class="headerlink" href="#create-variables" title="Permalink to this heading">#</a></h2>
<section id="dimensions">
<h3>Dimensions<a class="headerlink" href="#dimensions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_time</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,))</span>
<span class="n">t0_time</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;seconds since &#39;</span> <span class="o">+</span> <span class="n">start_time</span>
<span class="n">t0_time</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;Initial time&#39;</span>

<span class="n">latitude</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,))</span>
<span class="n">latitude</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_north&#39;</span>
<span class="n">latitude</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;latitude&#39;</span>

<span class="n">longitude</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">longitude</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;degrees_east&#39;</span>
<span class="n">longitude</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,))</span>
<span class="n">time</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;seconds since &#39;</span> <span class="o">+</span> <span class="n">start_time</span>
<span class="n">time</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>

<span class="n">lev</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
<span class="n">lev</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">lev</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;altitude&#39;</span>

<span class="c1">#pressure_o3 = ncfile.createVariable(&#39;pres_o3&#39;, np.float64, (&#39;pres_o3&#39;,))</span>
<span class="c1">#pressure_o3.units = &#39;Pa&#39;</span>
<span class="c1">#pressure_o3.long_name = &#39;pressure for o3&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initial-profiles">
<h3>Initial profiles<a class="headerlink" href="#initial-profiles" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pressure</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">pressure</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Pa&#39;</span>
<span class="n">pressure</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;pressure&#39;</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">u</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
<span class="n">u</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;zonal wind&#39;</span>

<span class="n">v</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">v</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
<span class="n">v</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;meridional wind&#39;</span>

<span class="n">temperature</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">temperature</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">temperature</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;temperature&#39;</span>

<span class="n">ptemperature</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">ptemperature</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">ptemperature</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;potential temperature&#39;</span>

<span class="n">qvapor</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;qv&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">qvapor</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;kg kg-1&#39;</span>
<span class="n">qvapor</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;specific humidity&#39;</span>

<span class="n">ozone</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;o3&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">ozone</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;kg kg-1&#39;</span>
<span class="n">ozone</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;ozone mass mixing ratio&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initial-sfc-conditions">
<h3>Initial sfc conditions<a class="headerlink" href="#initial-sfc-conditions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">ps</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Pa&#39;</span>
<span class="n">ps</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;surface pressure&#39;</span>

<span class="n">thetas</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;thetas&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">,))</span>
<span class="n">thetas</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">thetas</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;surface potential temperature&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-varying-forcing-geostrophic">
<h3>Time-varying forcing - geostrophic<a class="headerlink" href="#time-varying-forcing-geostrophic" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ug</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;ug&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
    <span class="n">ug</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
    <span class="n">ug</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;geostrophic zonal wind&#39;</span>

    <span class="n">vg</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;vg&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
    <span class="n">vg</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
    <span class="n">vg</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;geostrophic meridional wind&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-varying-forcing-nudging">
<h3>Time-varying forcing - nudging<a class="headerlink" href="#time-varying-forcing-nudging" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u_nudging</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;u_nudging&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
<span class="n">u_nudging</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
<span class="n">u_nudging</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;zonal wind profile for nudging&#39;</span>

<span class="n">v_nudging</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;v_nudging&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
<span class="n">v_nudging</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m s-1&#39;</span>
<span class="n">v_nudging</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;meridional wind profile for nudging&#39;</span>

<span class="k">if</span> <span class="n">do_t_qv_w</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">theta_nudging</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;theta_nudging&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
    <span class="n">theta_nudging</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
    <span class="n">theta_nudging</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;potential temperature profile for nudging&#39;</span>

    <span class="n">qv_nudging</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;qv_nudging&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
    <span class="n">qv_nudging</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;kg kg-1&#39;</span>
    <span class="n">qv_nudging</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;specific humidity profile for nudging&#39;</span>
    
    <span class="n">w_nudging</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;w_nudging&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">,))</span>
    <span class="n">w_nudging</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;Pa s-1&#39;</span>
    <span class="n">w_nudging</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;vertical velocity for nudging&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="time-varying-forcing-surface">
<h3>Time-varying forcing - surface<a class="headerlink" href="#time-varying-forcing-surface" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;ts&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,))</span>
<span class="n">ts</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">ts</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;surface temperature&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="misc">
<h3>Misc<a class="headerlink" href="#misc" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zw_grid</span> <span class="o">=</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">createVariable</span><span class="p">(</span><span class="s1">&#39;zw_grid&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;zw_grid&#39;</span><span class="p">,))</span>
<span class="n">zw_grid</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">zw_grid</span><span class="o">.</span><span class="n">long_name</span> <span class="o">=</span> <span class="s1">&#39;grid altitude at cell faces&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="write-data">
<h2>Write data<a class="headerlink" href="#write-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_time</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">latitude</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">les_lat_mid</span>
<span class="n">longitude</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">les_lon_mid</span>
<span class="n">lev</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">zgeoi</span>
<span class="n">zw_grid</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">z_grid</span>
<span class="n">pressure</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">pres_t0i</span>
<span class="c1">#pressure_o3[:] = pres_t0_o3</span>
<span class="n">u</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">uwnd_t0i</span>
<span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">vwnd_t0i</span>
<span class="n">temperature</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">temp_t0i</span>
<span class="n">ptemperature</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">theta_t0i</span>
<span class="n">qvapor</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">qv_t0i</span>
<span class="n">ozone</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">o3_t0i</span>

<span class="n">ps</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">ps_t0</span>
<span class="n">thetas</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">thetas_t0</span>

<span class="k">if</span> <span class="n">do_geo</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ug</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">ugeoi</span>
    <span class="n">vg</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">vgeoi</span>

<span class="n">u_nudging</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">unudgei</span>
<span class="n">v_nudging</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">vnudgei</span>

<span class="k">if</span> <span class="n">do_t_qv_w</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">theta_nudging</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">tnudgei</span>
    <span class="n">qv_nudging</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">qvnudgei</span>
    <span class="n">w_nudging</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">wnudgei</span>
    
<span class="n">ts</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">sst_ts</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="add-times">
<h2>Add times<a class="headerlink" href="#add-times" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nhrs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">nhrs</span> <span class="o">==</span> <span class="mi">19</span><span class="p">:</span>
        <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_hour</span><span class="o">+</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">23</span><span class="p">:</span>
            <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="n">start_hour</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">24</span><span class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="n">start_hour</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">24</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="n">start_hour</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
            <span class="nb">print</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="n">start_hour</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
<span class="n">time</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">times</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2020-03-12 19:00:00
2020-03-12 20:00:00
2020-03-12 21:00:00
2020-03-12 22:00:00
2020-03-12 23:00:00
2020-03-13 00:00:00
2020-03-13 01:00:00
2020-03-13 02:00:00
2020-03-13 03:00:00
2020-03-13 04:00:00
2020-03-13 05:00:00
2020-03-13 06:00:00
2020-03-13 07:00:00
2020-03-13 08:00:00
2020-03-13 09:00:00
2020-03-13 10:00:00
2020-03-13 11:00:00
2020-03-13 12:00:00
2020-03-13 13:00:00
2020-03-13 14:00:00
2020-03-13 15:00:00
2020-03-13 16:00:00
2020-03-13 17:00:00
2020-03-13 18:00:00
</pre></div>
</div>
</div>
</div>
</section>
<section id="close-the-file">
<h2>Close the file<a class="headerlink" href="#close-the-file" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first print the Dataset object to see what we&#39;ve got</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ncfile</span><span class="p">)</span>
<span class="c1"># close the Dataset.</span>
<span class="n">ncfile</span><span class="o">.</span><span class="n">close</span><span class="p">();</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dataset is closed!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;netCDF4._netCDF4.Dataset&#39;&gt;
root group (NETCDF3_CLASSIC data model, file format NETCDF3):
    title: Forcing and initial conditions for 13 March 2020 COMBLE intercomparison case
    reference: https://comble-intercomparison.readthedocs.io/en/latest/
    authors: Timothy W. Juliano (NCAR/RAL, tjuliano@ucar.edu); Florian Tornow (NASA/GISS, ft2544@columbia.edu); Ann M. Fridlind (NASA/GISS, ann.fridlind@nasa.gov)
    version: Created on 2023-06-01
    format_version: DEPHY SCM format version 2.0
    script: create_comble_forcing_v2.0.ipynb
    startDate: 2020-03-12 19:00:00
    endDate: 2020-03-13 18:00:00
    force_geo: 1
    surfaceType: ocean
    surfaceForcing: ts
    lat: 75.6 deg N
    dx: 150 m
    dy: 150 m
    dz: see zw_grid variable
    nx: 648
    ny: 648
    nz: 160
    dimensions(sizes): t0(1), lat(1), lon(1), lev(136), zw_grid(160), time(24)
    variables(dimensions): float32 t0(t0), float32 lat(lat), float32 lon(lon), float64 time(time), float64 lev(lev), float64 pressure(t0,lev,lat,lon), float64 u(t0,lev,lat,lon), float64 v(t0,lev,lat,lon), float64 temp(t0,lev,lat,lon), float64 theta(t0,lev,lat,lon), float64 qv(t0,lev,lat,lon), float64 o3(t0,lev,lat,lon), float64 ps(t0,lat,lon), float64 thetas(t0,lat,lon), float64 ug(time,lev), float64 vg(time,lev), float64 u_nudging(time,lev), float64 v_nudging(time,lev), float64 theta_nudging(time,lev), float64 qv_nudging(time,lev), float64 w_nudging(time,lev), float64 ts(time), float64 zw_grid(zw_grid)
    groups: 
Dataset is closed!
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/forcing"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../howto/workbench_instructions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Apply for Elevated JupyterHub Access</p>
      </div>
    </a>
    <a class="right-next"
       href="../conversion/convert_comble_dephy_forcing_to_DHARMA_LES_and_ModelE3_SCM_forcing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Example: convert DEPHY forcing to DHARMA and ModelE3 forcings</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Generate initial and time-varying profile and surface forcing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#developed-by-tim-juliano-ncar-ral-ann-fridlind-nasa-giss-and-florian-tornow-nasa-giss-columbia-univ">Developed by Tim Juliano (NCAR/RAL), Ann Fridlind (NASA-GISS), and Florian Tornow (NASA-GISS/Columbia Univ.)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#v2-0-created-on-6-1-23">v2.0 created on 6/1/23</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#we-have-the-option-of-starting-as-far-as-28-hours-before-arriving-at-andenes-03-12-20-at-14-utc">We have the option of starting as far as 28 hours before arriving at Andenes (03/12/20 at 14 UTC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#user-mods">!!! User mods !!!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-many-hours-before-ice-edge-do-you-want-to-start">How many hours before ice edge do you want to start?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-t0-h-0-means-you-are-starting-approx-at-ice-edge-t0-h-10-means-you-are-starting-10-h-upstream-north-of-the-ice-edge">Note: t0_h = 0 means you are starting approx. at ice edge, t0_h = 10 means you are starting 10 h upstream (north) of the ice edge</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-t0-h-must-be-an-integer">Note: t0_h must be an integer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-things">Set some things</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forcing-netcdf-name-and-delete-file-if-already-exists">Forcing NetCDF name and delete file if already exists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-les-domain-locations">Get LES domain locations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-vertical-grid">Create vertical grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vertical-grid-levels-defined-at-the-cell-faces">160 vertical grid levels, defined at the cell faces</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-in-data-from-era5-backtrajectory-netcdf">Read in data from ERA5 backtrajectory (netCDF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-units">Convert units</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reverse-time-dimension-of-2d-arrays-as-well-as-sfc-pressure-and-sst-so-that-beginning-of-backward-trajectory-is-in-first-position">Reverse time dimension of 2D arrays, as well as sfc pressure and sst, so that beginning of backward trajectory is in first position</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unmask-sst-field-and-get-index-according-to-t0-h-furthest-north-we-can-go-is-28h-after-backtrajectory-initialization-from-andenes-or-3-12-20-at-14-utc">Unmask sst field and get index according to t0_h (furthest north we can go is 28h after backtrajectory initialization from Andenes, or 3/12/20 at 14 UTC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-sfc-potential-temperature">Calculate sfc potential temperature</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-information-at-t0">Get information at t0</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extrapolate-o3-since-era5-only-goes-to-1-hpa-and-plot-versus-original-profile">Extrapolate O3 since ERA5 only goes to 1 hPa and plot versus original profile</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-geostrophic-wind-forcing">Get Geostrophic wind forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-extrapolate-ug-vg-to-native-era5-levels">Interpolate/extrapolate Ug/Vg to native ERA5 levels</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-t0-profiles-nudging-profiles-and-geostrophic-wind-profiles-to-common-vertical-grid-for-simplicity">Interpolate t0 profiles, nudging profiles, and geostrophic wind profiles to common vertical grid for simplicity</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#find-time-with-highest-first-level-and-get-vertical-grid">Find time with highest first level and get vertical grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-of-time-varying-geostrophic-profiles-to-new-vertical-grid">Do the linear interpolation of time-varying geostrophic profiles to new vertical grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-profiles-of-time-varying-geostrophic-wind-as-example-to-show-efficacy-of-method">Compare original and interpolated profiles of time-varying geostrophic wind as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-for-initial-forcing-profiles">Do the linear interpolation for initial forcing profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-linear-interpolation-for-nudging-forcing-profiles">Do the linear interpolation for nudging forcing profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-profiles-of-time-varying-nudging-wind-as-example-to-show-efficacy-of-method">Compare original and interpolated profiles of time-varying nudging wind as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-intial-profiles-as-example-to-show-efficacy-of-method">Compare original and interpolated intial profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-original-and-interpolated-nudging-profiles-as-example-to-show-efficacy-of-method">Compare original and interpolated nudging profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Compare original and interpolated nudging profiles as example to show efficacy of method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ageostrophic-winds">Compute ageostrophic winds</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#do-sfc-forcing">DO SFC FORCING</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-sea-ice-concentration-along-trajectory">Calculate sea ice concentration along trajectory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#get-time-series-information-for-sfc-forcing">Get time series information for sfc forcing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-new-netcdf-file">Create new netcdf file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-dimensions">Create dimensions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-global-attributes">Create global attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-variables">Create variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensions">Dimensions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-profiles">Initial profiles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-sfc-conditions">Initial sfc conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-geostrophic">Time-varying forcing - geostrophic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-nudging">Time-varying forcing - nudging</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-varying-forcing-surface">Time-varying forcing - surface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#misc">Misc</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-data">Write data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#add-times">Add times</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#close-the-file">Close the file</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ARM Development Team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
       Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>